<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; Datentransformation – Einführung in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./05-datenvisualisierung.html" rel="next">
<link href="./03-grundlagen.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./04-datentransformation.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Datentransformation</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./images/bayReuth-logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Einführung in R</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Lesemodus umschalten">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vorwort</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-einfuehrung.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Einführung</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Workflow</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-grundlagen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Grundlagen</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-datentransformation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Datentransformation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-datenvisualisierung.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Datenvisualisierung</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-datenimport-und-export.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Datenimport und -export</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-datenbereinigung.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Datenbereinigung</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-datenzusammenführung.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Datenzusammenführung</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-geodatenbearbeitung.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Geodatenbearbeitung</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-lernressourcen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lernressourcen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literatur</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#was-ist-das-tidyverse" id="toc-was-ist-das-tidyverse" class="nav-link active" data-scroll-target="#was-ist-das-tidyverse"><span class="header-section-number">4.1</span> Was ist das <code>tidyverse</code>?</a>
  <ul>
  <li><a href="#sec-datentransformation-tidyverse-dplyr" id="toc-sec-datentransformation-tidyverse-dplyr" class="nav-link" data-scroll-target="#sec-datentransformation-tidyverse-dplyr"><span class="header-section-number">4.1.1</span> <code>dplyr</code></a></li>
  <li><a href="#der-gapminder-datensatz" id="toc-der-gapminder-datensatz" class="nav-link" data-scroll-target="#der-gapminder-datensatz"><span class="header-section-number">4.1.2</span> Der <code>gapminder</code>-Datensatz</a></li>
  </ul></li>
  <li><a href="#zeilen" id="toc-zeilen" class="nav-link" data-scroll-target="#zeilen"><span class="header-section-number">4.2</span> Zeilen</a>
  <ul>
  <li><a href="#filtering" id="toc-filtering" class="nav-link" data-scroll-target="#filtering"><span class="header-section-number">4.2.1</span> Filtering</a>
  <ul class="collapse">
  <li><a href="#verknüpfte-bedingungen" id="toc-verknüpfte-bedingungen" class="nav-link" data-scroll-target="#verknüpfte-bedingungen"><span class="header-section-number">4.2.1.1</span> Verknüpfte Bedingungen</a></li>
  <li><a href="#duplikate" id="toc-duplikate" class="nav-link" data-scroll-target="#duplikate"><span class="header-section-number">4.2.1.2</span> Duplikate</a></li>
  </ul></li>
  <li><a href="#sec-datentransformation-zeilen-slicing" id="toc-sec-datentransformation-zeilen-slicing" class="nav-link" data-scroll-target="#sec-datentransformation-zeilen-slicing"><span class="header-section-number">4.2.2</span> Slicing</a></li>
  <li><a href="#sec-datentransformation-zeilen-arranging" id="toc-sec-datentransformation-zeilen-arranging" class="nav-link" data-scroll-target="#sec-datentransformation-zeilen-arranging"><span class="header-section-number">4.2.3</span> Arranging</a></li>
  </ul></li>
  <li><a href="#spalten" id="toc-spalten" class="nav-link" data-scroll-target="#spalten"><span class="header-section-number">4.3</span> Spalten</a>
  <ul>
  <li><a href="#sec-datentransformation-spalten-counting" id="toc-sec-datentransformation-spalten-counting" class="nav-link" data-scroll-target="#sec-datentransformation-spalten-counting"><span class="header-section-number">4.3.1</span> Counting</a></li>
  <li><a href="#selecting" id="toc-selecting" class="nav-link" data-scroll-target="#selecting"><span class="header-section-number">4.3.2</span> Selecting</a>
  <ul class="collapse">
  <li><a href="#einzelne-spalten-auswählen" id="toc-einzelne-spalten-auswählen" class="nav-link" data-scroll-target="#einzelne-spalten-auswählen"><span class="header-section-number">4.3.2.1</span> Einzelne Spalten auswählen</a></li>
  <li><a href="#sec-datentransformation-spalten-selecting-bereiche" id="toc-sec-datentransformation-spalten-selecting-bereiche" class="nav-link" data-scroll-target="#sec-datentransformation-spalten-selecting-bereiche"><span class="header-section-number">4.3.2.2</span> Spaltenbereiche auswählen</a></li>
  <li><a href="#spalten-entfernen" id="toc-spalten-entfernen" class="nav-link" data-scroll-target="#spalten-entfernen"><span class="header-section-number">4.3.2.3</span> Spalten entfernen</a></li>
  <li><a href="#spalten-verschieben" id="toc-spalten-verschieben" class="nav-link" data-scroll-target="#spalten-verschieben"><span class="header-section-number">4.3.2.4</span> Spalten verschieben</a></li>
  </ul></li>
  <li><a href="#renaming" id="toc-renaming" class="nav-link" data-scroll-target="#renaming"><span class="header-section-number">4.3.3</span> Renaming</a></li>
  <li><a href="#relocating" id="toc-relocating" class="nav-link" data-scroll-target="#relocating"><span class="header-section-number">4.3.4</span> Relocating</a></li>
  <li><a href="#sec-datentransformation-spalten-mutating" id="toc-sec-datentransformation-spalten-mutating" class="nav-link" data-scroll-target="#sec-datentransformation-spalten-mutating"><span class="header-section-number">4.3.5</span> Mutating</a>
  <ul class="collapse">
  <li><a href="#manuell-eingeben" id="toc-manuell-eingeben" class="nav-link" data-scroll-target="#manuell-eingeben"><span class="header-section-number">4.3.5.1</span> Manuell eingeben</a></li>
  <li><a href="#mit-konstanten-rechnen" id="toc-mit-konstanten-rechnen" class="nav-link" data-scroll-target="#mit-konstanten-rechnen"><span class="header-section-number">4.3.5.2</span> Mit Konstanten rechnen</a></li>
  <li><a href="#mit-vorhandenen-spalten-arbeiten" id="toc-mit-vorhandenen-spalten-arbeiten" class="nav-link" data-scroll-target="#mit-vorhandenen-spalten-arbeiten"><span class="header-section-number">4.3.5.3</span> Mit vorhandenen Spalten arbeiten</a></li>
  <li><a href="#spalten-behalten" id="toc-spalten-behalten" class="nav-link" data-scroll-target="#spalten-behalten"><span class="header-section-number">4.3.5.4</span> Spalten behalten</a></li>
  <li><a href="#sec-datentransformation-spalten-mutating-bedingungen" id="toc-sec-datentransformation-spalten-mutating-bedingungen" class="nav-link" data-scroll-target="#sec-datentransformation-spalten-mutating-bedingungen"><span class="header-section-number">4.3.5.5</span> Mit Bedingungen arbeiten</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#sec-datentranformation-gruppen" id="toc-sec-datentranformation-gruppen" class="nav-link" data-scroll-target="#sec-datentranformation-gruppen"><span class="header-section-number">4.4</span> Gruppen</a>
  <ul>
  <li><a href="#grouping" id="toc-grouping" class="nav-link" data-scroll-target="#grouping"><span class="header-section-number">4.4.1</span> Grouping</a></li>
  <li><a href="#summarizing" id="toc-summarizing" class="nav-link" data-scroll-target="#summarizing"><span class="header-section-number">4.4.2</span> Summarizing</a></li>
  </ul></li>
  <li><a href="#sec-datentransformation-uebungsaufgaben" id="toc-sec-datentransformation-uebungsaufgaben" class="nav-link" data-scroll-target="#sec-datentransformation-uebungsaufgaben"><span class="header-section-number">4.5</span> Übungsaufgaben</a>
  <ul>
  <li><a href="#überblick-verschaffen" id="toc-überblick-verschaffen" class="nav-link" data-scroll-target="#überblick-verschaffen"><span class="header-section-number">4.5.1</span> Überblick verschaffen</a></li>
  <li><a href="#filtering-1" id="toc-filtering-1" class="nav-link" data-scroll-target="#filtering-1"><span class="header-section-number">4.5.2</span> Filtering</a></li>
  <li><a href="#einmalige-kombinationen" id="toc-einmalige-kombinationen" class="nav-link" data-scroll-target="#einmalige-kombinationen"><span class="header-section-number">4.5.3</span> Einmalige Kombinationen</a></li>
  <li><a href="#slicing" id="toc-slicing" class="nav-link" data-scroll-target="#slicing"><span class="header-section-number">4.5.4</span> Slicing</a></li>
  <li><a href="#arranging" id="toc-arranging" class="nav-link" data-scroll-target="#arranging"><span class="header-section-number">4.5.5</span> Arranging</a></li>
  <li><a href="#selecting-1" id="toc-selecting-1" class="nav-link" data-scroll-target="#selecting-1"><span class="header-section-number">4.5.6</span> Selecting</a></li>
  <li><a href="#renaming-und-relocating" id="toc-renaming-und-relocating" class="nav-link" data-scroll-target="#renaming-und-relocating"><span class="header-section-number">4.5.7</span> Renaming und Relocating</a></li>
  <li><a href="#mutating" id="toc-mutating" class="nav-link" data-scroll-target="#mutating"><span class="header-section-number">4.5.8</span> Mutating</a></li>
  <li><a href="#grouping-und-summarizing" id="toc-grouping-und-summarizing" class="nav-link" data-scroll-target="#grouping-und-summarizing"><span class="header-section-number">4.5.9</span> Grouping und Summarizing</a></li>
  <li><a href="#längere-dplyr-pipelines" id="toc-längere-dplyr-pipelines" class="nav-link" data-scroll-target="#längere-dplyr-pipelines"><span class="header-section-number">4.5.10</span> Längere <code>dplyr</code>-Pipelines</a></li>
  <li><a href="#fortgeschrittenes" id="toc-fortgeschrittenes" class="nav-link" data-scroll-target="#fortgeschrittenes"><span class="header-section-number">4.5.11</span> Fortgeschrittenes</a></li>
  </ul></li>
  <li><a href="#lösungen" id="toc-lösungen" class="nav-link" data-scroll-target="#lösungen"><span class="header-section-number">4.6</span> Lösungen</a>
  <ul>
  <li><a href="#überblick-verschaffen-1" id="toc-überblick-verschaffen-1" class="nav-link" data-scroll-target="#überblick-verschaffen-1"><span class="header-section-number">4.6.1</span> Überblick verschaffen</a></li>
  <li><a href="#filtering-2" id="toc-filtering-2" class="nav-link" data-scroll-target="#filtering-2"><span class="header-section-number">4.6.2</span> Filtering</a></li>
  <li><a href="#einmalige-kombinationen-1" id="toc-einmalige-kombinationen-1" class="nav-link" data-scroll-target="#einmalige-kombinationen-1"><span class="header-section-number">4.6.3</span> Einmalige Kombinationen</a></li>
  <li><a href="#slicing-1" id="toc-slicing-1" class="nav-link" data-scroll-target="#slicing-1"><span class="header-section-number">4.6.4</span> Slicing</a></li>
  <li><a href="#arranging-1" id="toc-arranging-1" class="nav-link" data-scroll-target="#arranging-1"><span class="header-section-number">4.6.5</span> Arranging</a></li>
  <li><a href="#selecting-2" id="toc-selecting-2" class="nav-link" data-scroll-target="#selecting-2"><span class="header-section-number">4.6.6</span> Selecting</a></li>
  <li><a href="#renaming-und-relocating-1" id="toc-renaming-und-relocating-1" class="nav-link" data-scroll-target="#renaming-und-relocating-1"><span class="header-section-number">4.6.7</span> Renaming und Relocating</a></li>
  <li><a href="#mutating-1" id="toc-mutating-1" class="nav-link" data-scroll-target="#mutating-1"><span class="header-section-number">4.6.8</span> Mutating</a></li>
  <li><a href="#grouping-und-summarizing-1" id="toc-grouping-und-summarizing-1" class="nav-link" data-scroll-target="#grouping-und-summarizing-1"><span class="header-section-number">4.6.9</span> Grouping und Summarizing</a></li>
  <li><a href="#längere-dplyr-pipelines-1" id="toc-längere-dplyr-pipelines-1" class="nav-link" data-scroll-target="#längere-dplyr-pipelines-1"><span class="header-section-number">4.6.10</span> Längere <code>dplyr</code>-Pipelines</a></li>
  <li><a href="#fortgeschrittenes-1" id="toc-fortgeschrittenes-1" class="nav-link" data-scroll-target="#fortgeschrittenes-1"><span class="header-section-number">4.6.11</span> Fortgeschrittenes</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-datentransformation" class="quarto-section-identifier"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Datentransformation</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Bei der Arbeit mit Daten stehen wir fortwährend vor der Aufgabe, vorhandene Daten zu bearbeiten, um Fragen zu beantworten oder sie für weitere Auswertungsschritte vorzubereiten. Wir benötigen dabei Fähigkeiten, Daten zu transformieren, sie also unseren Erfordernissen entsprechend zu verändern. Hierfür stehen in R viele unterschiedliche Möglichkeiten zur Verfügung, von denen wir einige besonders beliebte und verbreitete kennenlernen möchten. Dabei werden wir lernen, dass die Arbeit mit Daten – in diesem Fall Tabellen – in R einfacher und nachvollziehbarer abläuft als etwa in Tabellenkalkulationssoftware.</p>
<p>In diesem Kapitel lernen wir…</p>
<ul>
<li>…was das <code>tidyverse</code> ist.</li>
<li>…wie wir die Zeilen und Spalten von Tabellen verändern.</li>
<li>…wie wir gruppenweise Operationen durchführen.</li>
</ul>
<p>Wir benötigen hierfür die folgenden Pakete:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nycflights13)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="was-ist-das-tidyverse" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="was-ist-das-tidyverse"><span class="header-section-number">4.1</span> Was ist das <code>tidyverse</code>?</h2>
<p>Ausgerüstet mit den wichtigsten Prinzipien und Begriffen rund um R, möchten wir in diesem Kapitel den Einstieg ins <code>tidyverse</code> wagen. Was aber genau ist das <code>tidyverse</code> eigentlich? Einen Hinweis bekommen wir, wenn wir das entsprechende Paket laden.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/tidyverse-packages.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption>Der <em>output</em> beim Laden des <code>tidyverse</code>-Pakets.</figcaption>
</figure>
</div>
</div>
</div>
<p>“Das” <code>tidyverse</code> ist eine <strong>Sammlung unterschiedlicher <em>packages</em></strong>, die ihrerseits eine Reihe wichtiger Funktionen zur Datenauswertung anbieten. Angestoßen durch den Programmierer Hadley Wickham, stehen hinter diesen Paketen viele Autor*innen, die der Wunsch eint, Funktionen mit einheitlichem <strong>Syntax</strong> (Reihenfolge von Argumenten, wichtig für die Nutzung der Pipe <code>|&gt;</code>), konsistenten und einprägsamen <strong>Namen</strong> und einem hohen Grad an <strong>Kompatibilität</strong> (Objektklassen von <em>input</em> und <em>output</em>) untereinander zu entwickeln. Zu den Schwerpunkten der <code>tidyverse</code>-Pakete gehören:</p>
<ul>
<li><strong><code>dplyr</code></strong>: Bearbeiten von <em>data frames</em> bzw. <em>tibbles</em></li>
<li><strong><code>forcats</code></strong>: Arbeiten mit <code>factor</code>s</li>
<li><strong><code>ggplot2</code></strong>: Visualisieren unterschiedlichster Daten</li>
<li><strong><code>lubridate</code></strong>: Arbeiten mit <code>Date</code>s</li>
<li><strong><code>purrr</code></strong>: Funktionales Programmieren</li>
<li><strong><code>readr</code></strong>: Einlesen und Schreiben von Daten unterschiedlicher Formate</li>
<li><strong><code>stringr</code></strong>: Arbeiten mit <code>characters</code>s</li>
<li><strong><code>tibble</code></strong>: Erstellen und konvertieren von <em>tibbles</em></li>
<li><strong><code>tidyr</code></strong>: Bereinigen von <em>data frames</em> bzw. <em>tibbles</em></li>
</ul>
<p>All diese Pakete werden auf einmal geladen, sobald wir <code>library(tidyverse)</code> ausführen.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> Dabei gibt es aber zwei <strong>Konflikte</strong>: in den Fällen der Funktionen <code>filter()</code> und <code>lag()</code> überschreiben <code>dplyr</code>-Funktionen nunmehr die gleichnamigen <em>base R</em>-Varianten aus dem Paket <code>stats</code>. Das heißt, wenn wir ab sofort <code>filter()</code> eingeben, wird die <code>dplyr</code>-Variante ausgeführt. Sollten wir doch die <code>stats</code>-Variante ausführen wollen, können wir das mit <code>stats::filter()</code><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> tun.</p>
<p>Nicht alles, was die <code>tidyverse</code>-Pakete bieten, ist dabei neu. In vielen Fällen handelt es sich eher um veränderte Funktionen von <em>base R</em>, die nichtsdestotrotz die Anwendung eleganter und, insbesondere für R-Einsteiger*innen, zugänglicher gestalten.</p>
<section id="sec-datentransformation-tidyverse-dplyr" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="sec-datentransformation-tidyverse-dplyr"><span class="header-section-number">4.1.1</span> <code>dplyr</code></h3>
<p>In diesem Abschnitt lernen wir die grundlegenden <strong>Verben</strong> von <code>dplyr</code> lernen, die zu den häufigsten genutzten Funktionen aller R-Nutzer*innen zählen. Dabei nutzen wir von nun an die Pipe (<code>|&gt;</code>), um Objekte und Funktionen zu verknüpfen. Desweiteren ist es nützlich, das entsprechende Cheatsheet (<a href="02-workflow.html#sec-workflow-hilfe-und-selbsthilfe-cheatsheets" class="quarto-xref"><span>Kapitel 2.4.5</span></a>) als Hilfsmittel zur Hand zu haben.</p>
<p>Für die meisten <code>dplyr</code>-Funktionen gelten dabei folgende Regeln:</p>
<ul>
<li>Daten müssen in einem <strong><em>tidy</em></strong> (“aufgeräumten”) <strong>Format</strong> vorliegen. Das bedeutet, dass jede Variable in einer eigenen Spalte und jede Beobachtung in einer eigenen Zeile.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></li>
<li>Der <strong>erste Parameter</strong> einer Funktion, <code>.data</code>, benötigt als Argument immer einen <em>data frame</em> bzw. eine <em>tibble</em>.</li>
<li>Die weiteren Argumente beschreiben typischerweise, mit welchen Spalten etwas gemacht werden soll. Hierfür werden die <strong>Spaltennamen ohne Anführungszeichen</strong> angegeben.</li>
<li>Der <em>output</em> ist immer ein neuer ein neuer <em>data frame</em> bzw. eine neue <em>tibble</em>.</li>
</ul>
<p>Der Einfachheit halber werden die meisten sogenannten <code>dplyr</code>-“Verben”<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> danach geordnet, ob sie Zeilen (<em>rows</em>), Spalten (<em>columns</em>), Gruppen (<em>groups</em>) oder Tabellen (<em>tables</em>) bearbeiten.</p>
</section>
<section id="der-gapminder-datensatz" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="der-gapminder-datensatz"><span class="header-section-number">4.1.2</span> Der <code>gapminder</code>-Datensatz</h3>
<p>Als <em>data frame</em> dient uns <code>gapminder</code>. Bei <code>gapminder</code> handelt es sich um einen <strong>Datensatz mit sozio-ökonomischen Daten</strong> von 142 Ländern zwischen den Jahren 1952 bis 2007. Über einen uns unbekannten <em>data frame</em> wie <code>gapminder</code> können wir uns gleich auf mehrere Arten einen <strong>Überblick verschaffen</strong>.</p>
<p>Mit **<code>glimpse()**</code> erfahren wir direkt, dass <code>gapminder</code> 1704 Zeilen und 6 Spalten hat, welche Datentypen diese Spalten haben und wie die ersten Werte aussehen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(gapminder) <span class="co"># Erster Blick auf gapminder</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,704
Columns: 6
$ country   &lt;fct&gt; "Afghanistan", "Afghanistan", "Afghanistan", "Afghanistan", …
$ continent &lt;fct&gt; Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, …
$ year      &lt;int&gt; 1952, 1957, 1962, 1967, 1972, 1977, 1982, 1987, 1992, 1997, …
$ lifeExp   &lt;dbl&gt; 28.801, 30.332, 31.997, 34.020, 36.088, 38.438, 39.854, 40.8…
$ pop       &lt;int&gt; 8425333, 9240934, 10267083, 11537966, 13079460, 14880372, 12…
$ gdpPercap &lt;dbl&gt; 779.4453, 820.8530, 853.1007, 836.1971, 739.9811, 786.1134, …</code></pre>
</div>
</div>
<p>Mit <strong><code>str()</code></strong> erfahren wir desweiteren noch wieviele unterschiedliche Ausprägungen (<em>levels</em>) die Variablen <code>country</code> und <code>continent</code> haben.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(gapminder) <span class="co"># Struktur von gapminder anzeigen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [1,704 × 6] (S3: tbl_df/tbl/data.frame)
 $ country  : Factor w/ 142 levels "Afghanistan",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ continent: Factor w/ 5 levels "Africa","Americas",..: 3 3 3 3 3 3 3 3 3 3 ...
 $ year     : int [1:1704] 1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 ...
 $ lifeExp  : num [1:1704] 28.8 30.3 32 34 36.1 ...
 $ pop      : int [1:1704] 8425333 9240934 10267083 11537966 13079460 14880372 12881816 13867957 16317921 22227415 ...
 $ gdpPercap: num [1:1704] 779 821 853 836 740 ...</code></pre>
</div>
</div>
<p>Desweiteren können wir uns mit <code>summary()</code> eine Art <strong>statistische Zusammenfassung</strong> der einzelnen Variablen anzeigen lassen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gapminder) <span class="co"># Zusammenfassung von gapminder anzeigen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        country        continent        year         lifeExp     
 Afghanistan:  12   Africa  :624   Min.   :1952   Min.   :23.60  
 Albania    :  12   Americas:300   1st Qu.:1966   1st Qu.:48.20  
 Algeria    :  12   Asia    :396   Median :1980   Median :60.71  
 Angola     :  12   Europe  :360   Mean   :1980   Mean   :59.47  
 Argentina  :  12   Oceania : 24   3rd Qu.:1993   3rd Qu.:70.85  
 Australia  :  12                  Max.   :2007   Max.   :82.60  
 (Other)    :1632                                                
      pop              gdpPercap       
 Min.   :6.001e+04   Min.   :   241.2  
 1st Qu.:2.794e+06   1st Qu.:  1202.1  
 Median :7.024e+06   Median :  3531.8  
 Mean   :2.960e+07   Mean   :  7215.3  
 3rd Qu.:1.959e+07   3rd Qu.:  9325.5  
 Max.   :1.319e+09   Max.   :113523.1  
                                       </code></pre>
</div>
</div>
<p>Mit <code>?gapminder</code> können wir schließlich mehr über die einzelnen Variablen erfahren:</p>
<ul>
<li><strong><code>country</code></strong>: Ein <code>factor</code>-Vektor mit 142 <em>levels</em>, also Ländernamen</li>
<li><strong><code>continent</code></strong>: Ein <code>factor</code>-Vektor mit 5 <em>levels</em>, also Kontinentnamen</li>
<li><strong><code>year</code></strong>: ein <code>integer</code>-Vektor mit Jahresangaben in 5-Jahres-Schritten</li>
<li><strong><code>lifeExp</code></strong>: ein <code>numeric</code>-Vektor mit der Lebenserwartung bei Geburt in Jahren</li>
<li><strong><code>pop</code></strong>: ein <code>integer</code>-Vektor mit der absoluten Bevölkerungszahl</li>
<li><strong><code>gdpPercap</code></strong>: ein <code>numeric</code>-Vektor mit dem Bruttoinlandsprodukt (BIP, <strong><em>g</em></strong><em>ross</em> <strong><em>d</em></strong><em>omestic</em> <strong><em>p</em></strong><em>roduct</em>) in inflationsbereinigten US-Dollar</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Piping
</div>
</div>
<div class="callout-body-container callout-body">
<p>In allen folgenden Beispielen beginnen wir, <strong>mehrere Arbeitsschritte mit der <em>pipe</em> zu verbinden</strong> (<a href="03-grundlagen.html#sec-grundlagen-r-funktionen" class="quarto-xref"><span>Kapitel 3.2.2</span></a>). Dabei empfiehlt sich, nach Eingabe der Pipe mit <kbd>Shift+Enter</kbd> eine neue Zeile zu beginnen. Auf diese Weise können wir unseren Code immer in folgender Form lesen und verstehen: <em>Mach erst dies, dann das.</em></p>
</div>
</div>
</section>
</section>
<section id="zeilen" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="zeilen"><span class="header-section-number">4.2</span> Zeilen</h2>
<section id="filtering" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="filtering"><span class="header-section-number">4.2.1</span> Filtering</h3>
<p>Oft möchten wir nicht mit einem gesamten Datensatz arbeiten, sondern nur mit einer bestimmten Auswahl. Oder wir möchten lediglich wissen, wieviele Beobachtungen mit bestimmten Eigenschaften in unserem größeren Datensatz stecken. In diesen und ähnlichen Fällen möchten wir einen Datensatz <strong>filtern</strong>, also anhand <strong>logischer Ausdrücke</strong> mit den uns bekannten Operatoren (<a href="03-grundlagen.html#sec-grundlagen-datentypen-mit-datentypen-arbeiten" class="quarto-xref"><span>Kapitel 3.4.8</span></a>) Bedingungen formulieren, anhand derer Zeilen ausgewählt oder fallengelassen (<em>drop</em>) werden.</p>
<p>Ein naheliegendes Beispiel ist, nur die Beobachtungen (Zeilen) für Deutschland auszuwählen. Hier ist unsere Bedingung, dass <code>country</code> dem Wert <code>Germany</code> entspricht, also <strong>gleich</strong> ist; folglich nutzen wir den <strong><code>==</code></strong>-Operator.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">"Germany"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 6
   country continent  year lifeExp      pop gdpPercap
   &lt;fct&gt;   &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
 1 Germany Europe     1952    67.5 69145952     7144.
 2 Germany Europe     1957    69.1 71019069    10188.
 3 Germany Europe     1962    70.3 73739117    12902.
 4 Germany Europe     1967    70.8 76368453    14746.
 5 Germany Europe     1972    71   78717088    18016.
 6 Germany Europe     1977    72.5 78160773    20513.
 7 Germany Europe     1982    73.8 78335266    22032.
 8 Germany Europe     1987    74.8 77718298    24639.
 9 Germany Europe     1992    76.1 80597764    26505.
10 Germany Europe     1997    77.3 82011073    27789.
11 Germany Europe     2002    78.7 82350671    30036.
12 Germany Europe     2007    79.4 82400996    32170.</code></pre>
</div>
</div>
<p>Die uns ausgegebene <em>tibble</em> hat nun also nicht mehr 1704, sondern nur noch 12 Zeilen. Mit <strong><code>!=</code></strong> könnten wir hingegen alle Beobachtungen, die sich <strong>nicht</strong> auf Deutschland beziehen, auswählen und so einen neuen <em>data frame</em> mit 1692 Zeilen erzeugen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">!=</span> <span class="st">"Germany"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,692 × 6
   country     continent  year lifeExp      pop gdpPercap
   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
 1 Afghanistan Asia       1952    28.8  8425333      779.
 2 Afghanistan Asia       1957    30.3  9240934      821.
 3 Afghanistan Asia       1962    32.0 10267083      853.
 4 Afghanistan Asia       1967    34.0 11537966      836.
 5 Afghanistan Asia       1972    36.1 13079460      740.
 6 Afghanistan Asia       1977    38.4 14880372      786.
 7 Afghanistan Asia       1982    39.9 12881816      978.
 8 Afghanistan Asia       1987    40.8 13867957      852.
 9 Afghanistan Asia       1992    41.7 16317921      649.
10 Afghanistan Asia       1997    41.8 22227415      635.
# ℹ 1,682 more rows</code></pre>
</div>
</div>
<p>Mit einem weiteren Operator, <strong><code>%in%</code></strong>, können wir <strong>mehrere Werte auswählen</strong>, nach deren Beobachtungen wir filtern möchten.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Belgium"</span>, <span class="st">"France"</span>, <span class="st">"Germany"</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 36 × 6
   country continent  year lifeExp      pop gdpPercap
   &lt;fct&gt;   &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
 1 Belgium Europe     1952    68    8730405     8343.
 2 Belgium Europe     1957    69.2  8989111     9715.
 3 Belgium Europe     1962    70.2  9218400    10991.
 4 Belgium Europe     1967    70.9  9556500    13149.
 5 Belgium Europe     1972    71.4  9709100    16672.
 6 Belgium Europe     1977    72.8  9821800    19118.
 7 Belgium Europe     1982    73.9  9856303    20980.
 8 Belgium Europe     1987    75.4  9870200    22526.
 9 Belgium Europe     1992    76.5 10045622    25576.
10 Belgium Europe     1997    77.5 10199787    27561.
# ℹ 26 more rows</code></pre>
</div>
</div>
<p>Bei numerischen Variablen können wir zudem mit den entsprechenden Operatoren gleichermaßen unsere Auswahl einschränken. Möchten wir nur Fälle seit 1990 auswählen, geben wir die Anweisung, dass <code>year</code> <strong>größer-gleich</strong> (<strong><code>&gt;=</code></strong>) 1990 sein soll.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">1990</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 568 × 6
   country     continent  year lifeExp      pop gdpPercap
   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
 1 Afghanistan Asia       1992    41.7 16317921      649.
 2 Afghanistan Asia       1997    41.8 22227415      635.
 3 Afghanistan Asia       2002    42.1 25268405      727.
 4 Afghanistan Asia       2007    43.8 31889923      975.
 5 Albania     Europe     1992    71.6  3326498     2497.
 6 Albania     Europe     1997    73.0  3428038     3193.
 7 Albania     Europe     2002    75.7  3508512     4604.
 8 Albania     Europe     2007    76.4  3600523     5937.
 9 Algeria     Africa     1992    67.7 26298373     5023.
10 Algeria     Africa     1997    69.2 29072015     4797.
# ℹ 558 more rows</code></pre>
</div>
</div>
<p>Wenn wir den Zeitraum nicht nur nach unten, sondern auch nach oben begrenzen möchten, können wir mithilfe des <strong><code>&amp;</code></strong>-Operators einfach zwei Bedingungen angeben, zum Beispiel dass <code>year</code> <strong>größer-gleich</strong> (<strong><code>&gt;=</code></strong>) 1990 und zugleich <strong>kleiner-gleich</strong> (<strong><code>&lt;=</code></strong>) 2000 sein soll.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">1990</span> <span class="sc">&amp;</span> year <span class="sc">&lt;=</span> <span class="dv">2000</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 284 × 6
   country     continent  year lifeExp      pop gdpPercap
   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
 1 Afghanistan Asia       1992    41.7 16317921      649.
 2 Afghanistan Asia       1997    41.8 22227415      635.
 3 Albania     Europe     1992    71.6  3326498     2497.
 4 Albania     Europe     1997    73.0  3428038     3193.
 5 Algeria     Africa     1992    67.7 26298373     5023.
 6 Algeria     Africa     1997    69.2 29072015     4797.
 7 Angola      Africa     1992    40.6  8735988     2628.
 8 Angola      Africa     1997    41.0  9875024     2277.
 9 Argentina   Americas   1992    71.9 33958947     9308.
10 Argentina   Americas   1997    73.3 36203463    10967.
# ℹ 274 more rows</code></pre>
</div>
</div>
<p>Um einfacheren Code hinsichtlich einer solchen <strong>Spanne</strong> numerischer Werte zu schreiben, können wir die Hilfsfunktion <strong><code>between()</code></strong> nutzen. Sie kommt innerhalb von <code>filter()</code> zum Einsatz und benötigt lediglich den Namen der Variable, nach der wir filtern möchten, sowie den niedrigsten und höchsten gewünschten Wert. Das Ergebnis ist dasselbe wie jenes der zwei mittels <code>&amp;</code> verknüpften Bedingungen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(year, <span class="dv">1990</span>, <span class="dv">2000</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 284 × 6
   country     continent  year lifeExp      pop gdpPercap
   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
 1 Afghanistan Asia       1992    41.7 16317921      649.
 2 Afghanistan Asia       1997    41.8 22227415      635.
 3 Albania     Europe     1992    71.6  3326498     2497.
 4 Albania     Europe     1997    73.0  3428038     3193.
 5 Algeria     Africa     1992    67.7 26298373     5023.
 6 Algeria     Africa     1997    69.2 29072015     4797.
 7 Angola      Africa     1992    40.6  8735988     2628.
 8 Angola      Africa     1997    41.0  9875024     2277.
 9 Argentina   Americas   1992    71.9 33958947     9308.
10 Argentina   Americas   1997    73.3 36203463    10967.
# ℹ 274 more rows</code></pre>
</div>
</div>
<section id="verknüpfte-bedingungen" class="level4" data-number="4.2.1.1">
<h4 data-number="4.2.1.1" class="anchored" data-anchor-id="verknüpfte-bedingungen"><span class="header-section-number">4.2.1.1</span> Verknüpfte Bedingungen</h4>
<p>Bislang haben wir nur Bedingungen mit Hinblick auf eine Variable verwendet. Wirklich nützlich wird <code>filter()</code> aber, wenn wir <strong>mehrere Bedingungen</strong> zusammen nutzen. Hierfür stehen uns mit <code>&amp;</code> (beide Bedingungen müssen erfüllt sein) und <strong><code>|</code></strong> (mind. eine Bedingung muss erfüllt sein) die entsprechenden Werkzeuge bereit. Möchten wir etwa nur die sich auf Deutschland beziehenden Beobachtungen <strong>und</strong> auf Jahre seit 1990 auswählen, nutzen wir <strong><code>&amp;</code></strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">"Germany"</span> <span class="sc">&amp;</span> year <span class="sc">&gt;=</span> <span class="dv">1990</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
  country continent  year lifeExp      pop gdpPercap
  &lt;fct&gt;   &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
1 Germany Europe     1992    76.1 80597764    26505.
2 Germany Europe     1997    77.3 82011073    27789.
3 Germany Europe     2002    78.7 82350671    30036.
4 Germany Europe     2007    79.4 82400996    32170.</code></pre>
</div>
</div>
<p>Eine andere Art, dasselbe Ergebnis zu erzielen, ist, die beiden Bedingungen einfach durch ein <strong>Komma</strong> (<code>,</code>) zu trennen. Auch in diesem Fall liest R es als ein <code>&amp;</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">"Germany"</span>, year <span class="sc">&gt;=</span> <span class="dv">1990</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
  country continent  year lifeExp      pop gdpPercap
  &lt;fct&gt;   &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
1 Germany Europe     1992    76.1 80597764    26505.
2 Germany Europe     1997    77.3 82011073    27789.
3 Germany Europe     2002    78.7 82350671    30036.
4 Germany Europe     2007    79.4 82400996    32170.</code></pre>
</div>
</div>
<p>Mit <code>|</code> wird die Tabelle hingegen entsprechend länger, denn nun werden alle Zeilen ausgewählt, die Deutschland repräsentieren <strong>oder</strong> deren Jahr mindestens 1990 beträgt.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">"Germany"</span> <span class="sc">|</span> year <span class="sc">&gt;=</span> <span class="dv">1990</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 576 × 6
   country     continent  year lifeExp      pop gdpPercap
   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
 1 Afghanistan Asia       1992    41.7 16317921      649.
 2 Afghanistan Asia       1997    41.8 22227415      635.
 3 Afghanistan Asia       2002    42.1 25268405      727.
 4 Afghanistan Asia       2007    43.8 31889923      975.
 5 Albania     Europe     1992    71.6  3326498     2497.
 6 Albania     Europe     1997    73.0  3428038     3193.
 7 Albania     Europe     2002    75.7  3508512     4604.
 8 Albania     Europe     2007    76.4  3600523     5937.
 9 Algeria     Africa     1992    67.7 26298373     5023.
10 Algeria     Africa     1997    69.2 29072015     4797.
# ℹ 566 more rows</code></pre>
</div>
</div>
</section>
<section id="duplikate" class="level4" data-number="4.2.1.2">
<h4 data-number="4.2.1.2" class="anchored" data-anchor-id="duplikate"><span class="header-section-number">4.2.1.2</span> Duplikate</h4>
<p>Es ist nie ausgeschlossen, dass Datensätze Duplikate enthalten, die die weitere Auswertung beeinflussen würden. Um diese <strong>Duplikate zu entfernen</strong>, können wir eine bestimmte Filterfunktion namens <strong><code>distinct()</code></strong> (“eindeutig”) heranziehen. In der folgenden <em>tibble</em> sind die Zeilen 1 und 2 Duplikate.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>my_tibble <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="co"># Zahlen-Vektor erzeugen</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> <span class="fu">rep</span>(<span class="st">"a"</span>, </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">times =</span> <span class="dv">4</span>)) <span class="co"># Character-Vektor erzeugen</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>my_tibble</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
      x y    
  &lt;dbl&gt; &lt;chr&gt;
1     1 a    
2     1 a    
3     2 a    
4     3 a    </code></pre>
</div>
</div>
<p>Sobald wir <code>distinct()</code> auf <code>my_tibble</code> anwenden, bleibt nur eine der beiden identischen Zeilen bestehen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>my_tibble <span class="sc">|&gt;</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
      x y    
  &lt;dbl&gt; &lt;chr&gt;
1     1 a    
2     2 a    
3     3 a    </code></pre>
</div>
</div>
<p>Doch darin erschöpft sich die Nützlichkeit von <code>distinct()</code> nicht. Nennen wir der Funktion weitere Spalten, gibt sie uns alle <strong>einmaligen Kombinationen</strong> aus.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(country, continent) <span class="sc">|&gt;</span> <span class="co"># Alle eindeutigen Kombinationen der zwei Spalten ausgeben</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>) <span class="co"># Aus Platzgründen: Nur die obersten drei Zeilen anzeigen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  country     continent
  &lt;fct&gt;       &lt;fct&gt;    
1 Afghanistan Asia     
2 Albania     Europe   
3 Algeria     Africa   </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Filtering mit <em>base R</em>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Nachdem wir ein Gespür dafür entwickelt haben, wie einfach das Filtern mit der <code>dplyr</code>-Variante von <code>filter()</code> ist, möchten wir wenigstens noch erwähnen, wie das gleiche Ergebnis mit <em>base R</em> erzielt werden könnte. Um auf diese Weise aus <code>gapminder</code> nur alle Zeilen auszugeben, bei denen <code>country == "Germany"</code> gilt, müssen wir die <strong>Indexschreibweise</strong> (<a href="03-grundlagen.html#sec-grundlagen-datenstrukturen-vektor" class="quarto-xref"><span>Kapitel 3.5.1</span></a>) in Kombination mit dem <strong><code>$</code>-Operator</strong> (<a href="03-grundlagen.html#sec-grundlagen-datenstrukturen-data-frame" class="quarto-xref"><span>Kapitel 3.5.3</span></a>) nutzen. Wir tun dies in zwei Schritten tun:</p>
<ol type="1">
<li>Mit <code>gapminder$country == "Germany"</code> erzeugen wir einen Vektor logischer Werte, der soviele Elemente (nämlich 1704) wie <code>gapminder</code> Zeilen hat.</li>
<li>Diesen Vektor wenden wir mit der Indexschreibweise auf <code>gapminder</code> an, indem wir ihn als Zeilenangabe <code>r</code> in <code>[r, c]</code> nutzen.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>gapminder[gapminder<span class="sc">$</span>country <span class="sc">==</span> <span class="st">"Germany"</span>, ] <span class="co"># Der zweite Index bleibt leer, weil wir alle Spalten auswählen möchten</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 6
   country continent  year lifeExp      pop gdpPercap
   &lt;fct&gt;   &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
 1 Germany Europe     1952    67.5 69145952     7144.
 2 Germany Europe     1957    69.1 71019069    10188.
 3 Germany Europe     1962    70.3 73739117    12902.
 4 Germany Europe     1967    70.8 76368453    14746.
 5 Germany Europe     1972    71   78717088    18016.
 6 Germany Europe     1977    72.5 78160773    20513.
 7 Germany Europe     1982    73.8 78335266    22032.
 8 Germany Europe     1987    74.8 77718298    24639.
 9 Germany Europe     1992    76.1 80597764    26505.
10 Germany Europe     1997    77.3 82011073    27789.
11 Germany Europe     2002    78.7 82350671    30036.
12 Germany Europe     2007    79.4 82400996    32170.</code></pre>
</div>
</div>
<p>Möchten wir zwei Bedingungen anwenden, können wir innerhalb der Indexangabe die uns bekannten Operatoren nutzen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>gapminder[gapminder<span class="sc">$</span>country <span class="sc">==</span> <span class="st">"Germany"</span> <span class="sc">&amp;</span> gapminder<span class="sc">$</span>year <span class="sc">&gt;=</span> <span class="dv">1990</span>, ] <span class="co"># Nur die Beobachtungen Deutschlands ab dem Jahr 1990 ausgeben</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
  country continent  year lifeExp      pop gdpPercap
  &lt;fct&gt;   &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
1 Germany Europe     1992    76.1 80597764    26505.
2 Germany Europe     1997    77.3 82011073    27789.
3 Germany Europe     2002    78.7 82350671    30036.
4 Germany Europe     2007    79.4 82400996    32170.</code></pre>
</div>
</div>
<p>Mit dieser Schreibweise ist nichts falsch und sie wird uns immer wieder beim Stöbern nach Lösungen für eigenen R-Arbeiten begegnen. Dennoch sollte ersichtlich sein, dass die <code>dplyr</code>-Variante deutlich leichter zu lesen und zu verstehen ist.</p>
<p><strong>Im weiteren Verlauf werden wir deshalb nur selten <em>base R</em> heranziehen, sondern uns auf <code>tidyverse</code>-Varianten konzentrieren.</strong></p>
</div>
</div>
</section>
</section>
<section id="sec-datentransformation-zeilen-slicing" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="sec-datentransformation-zeilen-slicing"><span class="header-section-number">4.2.2</span> Slicing</h3>
<p>Eine nützliche Erweiterung von <code>filter()</code> sind die <strong><code>slice_*()</code></strong>-Funktionen. Weil <em>data frames</em> durchnummeriert sind, können wir mit <strong><code>slice()</code></strong> <strong>eine bestimmte Zeile</strong> anzeigen lassen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">2</span>) <span class="co"># Nur die zweite Zeile auswählen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  country     continent  year lifeExp     pop gdpPercap
  &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;     &lt;dbl&gt;
1 Afghanistan Asia       1957    30.3 9240934      821.</code></pre>
</div>
</div>
<p>Gleichermaßen können wir einen <strong>Bereich</strong> an Zeilen auswählen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>) <span class="co"># Nur die Zeilen 2 bis 5 auswählen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
  country     continent  year lifeExp      pop gdpPercap
  &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
1 Afghanistan Asia       1957    30.3  9240934      821.
2 Afghanistan Asia       1962    32.0 10267083      853.
3 Afghanistan Asia       1967    34.0 11537966      836.
4 Afghanistan Asia       1972    36.1 13079460      740.</code></pre>
</div>
</div>
<p>Analog zu den uns bereits bekannten <code>head()</code> und <code>tail()</code> (<a href="03-grundlagen.html#sec-grundlagen-datenstrukturen-data-frame" class="quarto-xref"><span>Kapitel 3.5.3</span></a>) können wir mit <strong><code>slice_head()</code></strong> und <strong><code>slice_tail()</code></strong> auch eine <strong>bestimmte Anzahl der obersten oder untersten Zeilen</strong> ausgeben.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">2</span>) <span class="co"># Nur die obersten zwei Zeilen auswählen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 6
  country     continent  year lifeExp     pop gdpPercap
  &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;     &lt;dbl&gt;
1 Afghanistan Asia       1952    28.8 8425333      779.
2 Afghanistan Asia       1957    30.3 9240934      821.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_tail</span>(<span class="at">n =</span> <span class="dv">2</span>) <span class="co"># Nur die untersten zwei Zeilen auswählen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 6
  country  continent  year lifeExp      pop gdpPercap
  &lt;fct&gt;    &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
1 Zimbabwe Africa     2002    40.0 11926563      672.
2 Zimbabwe Africa     2007    43.5 12311143      470.</code></pre>
</div>
</div>
<p>Regelmäßig sind wir aber besonders an den <strong>höchsten oder niedrigsten Werten einer Variable</strong> interessiert. Mit <strong><code>slice_min(x, n)</code></strong> und <strong><code>slice_max(x, n)</code></strong> können wir die <code>n</code><a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> Zeilen mit den niedrigsten bzw. höchsten Werten<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> einer Variable <code>x</code> ausgeben lassen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_min</span>(gdpPercap, <span class="at">n =</span> <span class="dv">5</span>) <span class="co"># Nur die fünf Zeilen mit den niedrigsten Pro-Kopf-BIP-Werten ausgeben</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 6
  country          continent  year lifeExp      pop gdpPercap
  &lt;fct&gt;            &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
1 Congo, Dem. Rep. Africa     2002    45.0 55379852      241.
2 Congo, Dem. Rep. Africa     2007    46.5 64606759      278.
3 Lesotho          Africa     1952    42.1   748747      299.
4 Guinea-Bissau    Africa     1952    32.5   580653      300.
5 Congo, Dem. Rep. Africa     1997    42.6 47798986      312.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(gdpPercap, <span class="at">n =</span> <span class="dv">5</span>) <span class="co"># Nur die fünf Zeilen mit den höchsten Pro-Kopf-BIP-Werten ausgeben</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 6
  country continent  year lifeExp    pop gdpPercap
  &lt;fct&gt;   &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;  &lt;int&gt;     &lt;dbl&gt;
1 Kuwait  Asia       1957    58.0 212846   113523.
2 Kuwait  Asia       1972    67.7 841934   109348.
3 Kuwait  Asia       1952    55.6 160000   108382.
4 Kuwait  Asia       1962    60.5 358266    95458.
5 Kuwait  Asia       1967    64.6 575003    80895.</code></pre>
</div>
</div>
</section>
<section id="sec-datentransformation-zeilen-arranging" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="sec-datentransformation-zeilen-arranging"><span class="header-section-number">4.2.3</span> Arranging</h3>
<p>Wenn wir Tabellen begegnen, deren Zeilen für uns nicht nachvollziehbar geordnet sind, möchten wir deren <strong>Anordnung verändern</strong>. Mit <strong><code>arrange()</code></strong> können wir unsere Tabelle nach den Werten einer oder mehrerer Spalten ordnen, indem wir die Variablennamen angeben. Standardmäßig ordnet <code>arrange()</code> dabei die Werte <strong>aufsteigend</strong>.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(lifeExp) <span class="sc">|&gt;</span> <span class="co"># Ordnen nach lifeExp, aufsteigend</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>) <span class="co"># Aus Platzgründen: Nur die obersten drei Zeilen anzeigen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 6
  country     continent  year lifeExp     pop gdpPercap
  &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;     &lt;dbl&gt;
1 Rwanda      Africa     1992    23.6 7290203      737.
2 Afghanistan Asia       1952    28.8 8425333      779.
3 Gambia      Africa     1952    30    284320      485.</code></pre>
</div>
</div>
<p>Um die Werte <strong>absteigend</strong> zu ordnen, müssen wir den Variablennamen einfach in die Funktion <strong><code>desc()</code></strong> (<em>descending</em>) schreiben.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(lifeExp)) <span class="sc">|&gt;</span> <span class="co"># Ordnen nach lifeExp, absteigend</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>) <span class="co"># Aus Platzgründen: Nur die obersten drei Zeilen anzeigen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 6
  country          continent  year lifeExp       pop gdpPercap
  &lt;fct&gt;            &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;     &lt;int&gt;     &lt;dbl&gt;
1 Japan            Asia       2007    82.6 127467972    31656.
2 Hong Kong, China Asia       2007    82.2   6980412    39725.
3 Japan            Asia       2002    82   127065841    28605.</code></pre>
</div>
</div>
</section>
</section>
<section id="spalten" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="spalten"><span class="header-section-number">4.3</span> Spalten</h2>
<section id="sec-datentransformation-spalten-counting" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="sec-datentransformation-spalten-counting"><span class="header-section-number">4.3.1</span> Counting</h3>
<p>Um die Inhalte von Spalten besser kennenzulernen, können wir gerade zu Beginn einer Auswertung auf einfache Berechnungen zurückgreifen. Zum Beispiel möchten wir wissen, wieviele Male jede Ausprägung einer bestimmte <code>factor</code>- oder <code>character</code>-<strong>Variable</strong> in einer Tabelle enthalten ist. Für derartiges <strong>Zählen</strong> nutzen wir <strong><code>count()</code></strong> und müssen lediglich den Namen einer Variable angeben. Um etwa zu erfahren, wieviele Male jeder <code>continent</code> vertreten ist, genügt folgender Code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(continent) <span class="co"># Zählen der Anzahl von continent-Ausprägungen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  continent     n
  &lt;fct&gt;     &lt;int&gt;
1 Africa      624
2 Americas    300
3 Asia        396
4 Europe      360
5 Oceania      24</code></pre>
</div>
</div>
<p>Gerade bei solchen Übersichten ist es ratsam, die Ergebnistabelle zu ordnen. Hierfür liegt mit <strong><code>sort</code></strong> ein Parameter vor, der mit dem Argument <code>TRUE</code> eine absteigende Anordnung bewirkt.<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(continent, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="co"># Zählen der Anzahl von continent-Ausprägungen, absteigend</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  continent     n
  &lt;fct&gt;     &lt;int&gt;
1 Africa      624
2 Asia        396
3 Europe      360
4 Americas    300
5 Oceania      24</code></pre>
</div>
</div>
</section>
<section id="selecting" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="selecting"><span class="header-section-number">4.3.2</span> Selecting</h3>
<p>Ähnlich wie <code>filter()</code> für das Auswählen von Zeilen verantwortlich ist, kümmert sich <strong><code>select()</code></strong> um das Auswählen von <strong>Spalten</strong>. Als Parameter benötigt <code>select()</code> entweder die <strong>Position</strong> oder die <strong>Bezeichnung</strong> der Spalte(n), die ausgewählt werden sollen.</p>
<section id="einzelne-spalten-auswählen" class="level4" data-number="4.3.2.1">
<h4 data-number="4.3.2.1" class="anchored" data-anchor-id="einzelne-spalten-auswählen"><span class="header-section-number">4.3.2.1</span> Einzelne Spalten auswählen</h4>
<p>Möchten wir die Position angeben, genügt eine Aufzählung der jeweiligen Spalten, getrennt durch ein <code>,</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="co"># Auswahl von einer Spalten nach Position: country</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>) <span class="co"># Aus Platzgründen: Nur die obersten drei Zeilen anzeigen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 1
  country    
  &lt;fct&gt;      
1 Afghanistan
2 Afghanistan
3 Afghanistan</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>) <span class="sc">|&gt;</span> <span class="co"># Auswahl von drei Spalten nach Position: country, year, pop</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>) <span class="co"># Aus Platzgründen: Nur die obersten drei Zeilen anzeigen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  country      year      pop
  &lt;fct&gt;       &lt;int&gt;    &lt;int&gt;
1 Afghanistan  1952  8425333
2 Afghanistan  1957  9240934
3 Afghanistan  1962 10267083</code></pre>
</div>
</div>
<p>Wenn wir Spalten nach ihren Bezeichnungen angeben wollen, verfahren wir gleichermaßen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country) <span class="sc">|&gt;</span> <span class="co"># Auswahl von einer Spalten: country</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>) <span class="co"># Aus Platzgründen: Nur die obersten drei Zeilen anzeigen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 1
  country    
  &lt;fct&gt;      
1 Afghanistan
2 Afghanistan
3 Afghanistan</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, year) <span class="sc">|&gt;</span> <span class="co"># Auswahl von zwei Spalten: country, year</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>) <span class="co"># Aus Platzgründen: Nur die obersten drei Zeilen anzeigen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  country      year
  &lt;fct&gt;       &lt;int&gt;
1 Afghanistan  1952
2 Afghanistan  1957
3 Afghanistan  1962</code></pre>
</div>
</div>
<p>Bei der Auswahl einer Spalte durch ihren Namen können wir sie auch <strong>umbenennen</strong>, indem wir einer neuen Spaltenbezeichnung die Werte der alten Spaltenbezeichnung zuweisen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">nation =</span> country) <span class="sc">|&gt;</span> <span class="co"># Auswahl und Umbennung der Spalte country</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>) <span class="co"># Aus Platzgründen: Nur die obersten drei Zeilen anzeigen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 1
  nation     
  &lt;fct&gt;      
1 Afghanistan
2 Afghanistan
3 Afghanistan</code></pre>
</div>
</div>
</section>
<section id="sec-datentransformation-spalten-selecting-bereiche" class="level4" data-number="4.3.2.2">
<h4 data-number="4.3.2.2" class="anchored" data-anchor-id="sec-datentransformation-spalten-selecting-bereiche"><span class="header-section-number">4.3.2.2</span> Spaltenbereiche auswählen</h4>
<p>Möchten wir eine <strong>Reihe aufeinander folgender Spalten</strong> auswählen, können wir uns dem uns bereits bekannten <strong><code>:</code></strong>-Operator bedienen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">|&gt;</span> <span class="co"># Auswahl von drei Spalten nach Positionsbereich: country, continent, year</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>) <span class="co"># Aus Platzgründen: Nur die obersten drei Zeilen anzeigen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  country     continent  year
  &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;
1 Afghanistan Asia       1952
2 Afghanistan Asia       1957
3 Afghanistan Asia       1962</code></pre>
</div>
</div>
<p>Neu ist, dass wir <code>:</code> auch mit den Spaltenbezeichnungen verwenden können.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country<span class="sc">:</span>year) <span class="sc">|&gt;</span> <span class="co"># Auswahl von drei Spalten nach Bezeichnungsbereich: country, continent, year</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>) <span class="co"># Aus Platzgründen: Nur die obersten drei Zeilen anzeigen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  country     continent  year
  &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;
1 Afghanistan Asia       1952
2 Afghanistan Asia       1957
3 Afghanistan Asia       1962</code></pre>
</div>
</div>
<p>Neben <code>:</code> bietet <code>select()</code> mehrere <strong>Hilfsfunktionen</strong> (<em>helper functions</em>) an, die Spalten aufgrund bestimmter enthaltener Buchstabenkombinationen oder Zahlenbereiche<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a> auswählen. Eine unvollständige Auswahl lautet wie folgt:</p>
<ul>
<li><strong><code>contains()</code></strong> (“enthält”): Mit <code>gapminder |&gt; select(contains("co"))</code> werden alle Spalten ausgewählt, die in ihrer Bezeichnung die Buchstabenkombination <code>co</code> tragen, in diesem Fall <code>country</code> und <code>continent</code>.</li>
<li><strong><code>starts_with()</code></strong> (“beginnt mit”): Mit <code>gapminder |&gt; select(starts_with("c"))</code> werden alle Spalten ausgewählt, deren Bezeichnung mit <code>c</code> beginnt, in diesem Fall abermals <code>country</code> und <code>continent</code>.</li>
<li><strong><code>ends_with()</code></strong> (“endet auf”): Mit <code>gapminder |&gt; select(ends_with("p"))</code> werden alle Spalten ausgewählt, deren Bezeichnung auf <code>p</code> endet, in diesem Fall <code>lifeExp</code>, <code>pop</code> und <code>gdpPercap</code>.</li>
</ul>
</section>
<section id="spalten-entfernen" class="level4" data-number="4.3.2.3">
<h4 data-number="4.3.2.3" class="anchored" data-anchor-id="spalten-entfernen"><span class="header-section-number">4.3.2.3</span> Spalten entfernen</h4>
<p>Mit einem <strong><code>!</code></strong> können wir die Wirkung von <code>select()</code> umdrehen.<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a> Statt eine Spalte auszuwählen, wird in der neuen Tabelle die entsprechende Spalte <strong>entfernt</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="co"># Entfernen einer Spalte nach Position: country</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>) <span class="co"># Aus Platzgründen: Nur die obersten drei Zeilen anzeigen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  continent  year lifeExp      pop gdpPercap
  &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
1 Asia       1952    28.8  8425333      779.
2 Asia       1957    30.3  9240934      821.
3 Asia       1962    32.0 10267083      853.</code></pre>
</div>
</div>
</section>
<section id="spalten-verschieben" class="level4" data-number="4.3.2.4">
<h4 data-number="4.3.2.4" class="anchored" data-anchor-id="spalten-verschieben"><span class="header-section-number">4.3.2.4</span> Spalten verschieben</h4>
<p>Durch die Auswahl bestimmter Spalten können wir eine neue Tabelle erzeugen, in der wir die <strong>Reihenfolge der Ursprungstabelle ändern</strong>. Möchten wir anstelle der Reihenfolge <code>country</code>, <code>continent</code>, <code>year</code> die Spalte <code>year</code> zuvorderst positionieren, müssen wir diese Spalten nur in unserem Befehl verändern.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, country, continent) <span class="sc">|&gt;</span> <span class="co"># Auswahl von drei Spalten sowie Verändern der Reihenfolge</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>) <span class="co"># Aus Platzgründen: Nur die obersten drei Zeilen anzeigen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
   year country     continent
  &lt;int&gt; &lt;fct&gt;       &lt;fct&gt;    
1  1952 Afghanistan Asia     
2  1957 Afghanistan Asia     
3  1962 Afghanistan Asia     </code></pre>
</div>
</div>
<p>Wenn wir nur eine Spalte nach vorne ziehen, den Rest aber unverändert lassen möchten, können wir uns mit dem <em>helper</em> <strong><code>everything()</code></strong> die Angabe aller restlichen Spalten sparen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, <span class="fu">everything</span>()) <span class="sc">|&gt;</span> <span class="co"># Nur Verändern der Reihenfolge</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>) <span class="co"># Aus Platzgründen: Nur die obersten drei Zeilen anzeigen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 6
   year country     continent lifeExp      pop gdpPercap
  &lt;int&gt; &lt;fct&gt;       &lt;fct&gt;       &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
1  1952 Afghanistan Asia         28.8  8425333      779.
2  1957 Afghanistan Asia         30.3  9240934      821.
3  1962 Afghanistan Asia         32.0 10267083      853.</code></pre>
</div>
</div>
</section>
</section>
<section id="renaming" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="renaming"><span class="header-section-number">4.3.3</span> Renaming</h3>
<p>Bis hierhin haben wir gesehen, wie wir <strong>Spalten</strong> mit <code>select()</code> <strong>umbenennen</strong> können. Dieser Schritt geht aber nur, wenn wir zugleich auch diese Spalte auswählen möchten. Wollen wir eine Spalte umbenennen und die <strong>Tabelle ansonsten nicht verändern</strong>, verwenden wir <strong><code>rename()</code></strong> und geben eine neue Spaltenbezeichnung an, der wir den Inhalt einer bestehenden Spalte zuweisen.<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">nation =</span> country) <span class="sc">|&gt;</span> <span class="co"># Umbennung der Spalte country</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>) <span class="co"># Aus Platzgründen: Nur die obersten drei Zeilen anzeigen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 6
  nation      continent  year lifeExp      pop gdpPercap
  &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
1 Afghanistan Asia       1952    28.8  8425333      779.
2 Afghanistan Asia       1957    30.3  9240934      821.
3 Afghanistan Asia       1962    32.0 10267083      853.</code></pre>
</div>
</div>
</section>
<section id="relocating" class="level3" data-number="4.3.4">
<h3 data-number="4.3.4" class="anchored" data-anchor-id="relocating"><span class="header-section-number">4.3.4</span> Relocating</h3>
<p>Ähnlich simpel wie <code>rename()</code> ist <strong><code>relocate()</code></strong> gestrickt. Mit dieser Funktion können wir einzelne <strong>Spalten verschieben</strong>, diesmal ohne den Rest der Tabelle zu verändern. Standardmäßig wird dabei die ausgewählte Spalte nach ganz vorn gezogen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(year) <span class="sc">|&gt;</span> <span class="co"># Verschieben der Spalte year</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>) <span class="co"># Aus Platzgründen: Nur die obersten drei Zeilen anzeigen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 6
   year country     continent lifeExp      pop gdpPercap
  &lt;int&gt; &lt;fct&gt;       &lt;fct&gt;       &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
1  1952 Afghanistan Asia         28.8  8425333      779.
2  1957 Afghanistan Asia         30.3  9240934      821.
3  1962 Afghanistan Asia         32.0 10267083      853.</code></pre>
</div>
</div>
<p>Wollen wir eine Spalte an eine bestimmte Position verschieben, können wir die Argumente <strong><code>.before</code></strong> bzw. <strong><code>.after</code></strong> verändern nutzen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(year, <span class="at">.before =</span> continent) <span class="sc">|&gt;</span> <span class="co"># Verschieben der Spalte year hinter die Spalte continent</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>) <span class="co"># Aus Platzgründen: Nur die obersten drei Zeilen anzeigen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 6
  country      year continent lifeExp      pop gdpPercap
  &lt;fct&gt;       &lt;int&gt; &lt;fct&gt;       &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
1 Afghanistan  1952 Asia         28.8  8425333      779.
2 Afghanistan  1957 Asia         30.3  9240934      821.
3 Afghanistan  1962 Asia         32.0 10267083      853.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(year, <span class="at">.after =</span> gdpPercap) <span class="sc">|&gt;</span> <span class="co"># Verschieben der Spalte year hinter die Spalte country</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>) <span class="co"># Aus Platzgründen: Nur die obersten drei Zeilen anzeigen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 6
  country     continent lifeExp      pop gdpPercap  year
  &lt;fct&gt;       &lt;fct&gt;       &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt; &lt;int&gt;
1 Afghanistan Asia         28.8  8425333      779.  1952
2 Afghanistan Asia         30.3  9240934      821.  1957
3 Afghanistan Asia         32.0 10267083      853.  1962</code></pre>
</div>
</div>
</section>
<section id="sec-datentransformation-spalten-mutating" class="level3" data-number="4.3.5">
<h3 data-number="4.3.5" class="anchored" data-anchor-id="sec-datentransformation-spalten-mutating"><span class="header-section-number">4.3.5</span> Mutating</h3>
<section id="manuell-eingeben" class="level4" data-number="4.3.5.1">
<h4 data-number="4.3.5.1" class="anchored" data-anchor-id="manuell-eingeben"><span class="header-section-number">4.3.5.1</span> Manuell eingeben</h4>
<p>Selten enthält eine Tabelle alle Informationen so, wie wir sie benötigen. Mit <strong><code>mutate()</code></strong> (zu deutsch “verwandeln”) können wir <strong>neue Variablen erzeugen</strong> und unserer Tabelle anhängen. Der einfachste Fall ist dabei, einem Variablennamen einen Vektor (idealerweise mit derselben Länge wie der Tabelle) zuzuweisen. Möchten wir unsere Tabelle <code>my_data_frame</code> (<a href="03-grundlagen.html#sec-grundlagen-datenstrukturen-data-frame" class="quarto-xref"><span>Kapitel 3.5.3</span></a>) also um eine neue Variable namens <code>number</code> ergänzen, nennen wir <code>mutate()</code> einfach den Namen und einen neuen Vektor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>my_data_frame <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">name =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>), <span class="at">times =</span> <span class="dv">5</span>), <span class="co"># Character-Vektor erzeugen</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">number =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>), <span class="co"># Zufallszahlen erzeugen</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>) <span class="co"># Strings als factors behandeln</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>my_data_frame</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   name     number
1     A  0.0690451
2     B -1.2167246
3     A  0.4833398
4     B  0.4481453
5     A -1.4707950
6     B -0.4827690
7     A -0.1449537
8     B -0.1352923
9     A -0.1411728
10    B  0.6464303</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>my_data_frame <span class="sc">|&gt;</span> </span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">number_2 =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>)) <span class="co"># Erzeugen einer neuen Variable number_2 mit 10 Zufallszahlen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   name     number    number_2
1     A  0.0690451 -0.91968891
2     B -1.2167246  1.80506131
3     A  0.4833398 -0.49421038
4     B  0.4481453  0.93875809
5     A -1.4707950  1.08971386
6     B -0.4827690 -1.50655134
7     A -0.1449537 -0.08164807
8     B -0.1352923 -1.47958438
9     A -0.1411728  1.27700835
10    B  0.6464303 -1.10132625</code></pre>
</div>
</div>
</section>
<section id="mit-konstanten-rechnen" class="level4" data-number="4.3.5.2">
<h4 data-number="4.3.5.2" class="anchored" data-anchor-id="mit-konstanten-rechnen"><span class="header-section-number">4.3.5.2</span> Mit Konstanten rechnen</h4>
<p>Oft ist es nötig, dass wir die <strong>Werte bestimmter Variablen transformieren</strong> möchten, zum Beispiel um andere Maßeinheiten zu nutzen. Wie bei der Arbeit mit Vektoren (<a href="03-grundlagen.html#sec-grundlagen-datenstrukturen-vektor" class="quarto-xref"><span>Kapitel 3.5.1</span></a>) können wir innerhalb von <code>mutate()</code> dafür Konstanten nutzen. Möchten wir in der <code>gapminder</code>-Tabelle etwa eine neue Variable (<code>pop_mn</code>) auf Basis einer bestehenden Variable (<code>pop</code>) berechnen, die die Bevölkerung in Millionen angibt, können wir die Ergebnisse der Berechnung <code>pop / 1000000</code> (bzw. <code>pop / 1e06</code>) ebenso einer neuen Variable zuweisen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pop_mn =</span> pop <span class="sc">/</span> <span class="dv">1000000</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,704 × 7
   country     continent  year lifeExp      pop gdpPercap pop_mn
   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;  &lt;dbl&gt;
 1 Afghanistan Asia       1952    28.8  8425333      779.   8.43
 2 Afghanistan Asia       1957    30.3  9240934      821.   9.24
 3 Afghanistan Asia       1962    32.0 10267083      853.  10.3 
 4 Afghanistan Asia       1967    34.0 11537966      836.  11.5 
 5 Afghanistan Asia       1972    36.1 13079460      740.  13.1 
 6 Afghanistan Asia       1977    38.4 14880372      786.  14.9 
 7 Afghanistan Asia       1982    39.9 12881816      978.  12.9 
 8 Afghanistan Asia       1987    40.8 13867957      852.  13.9 
 9 Afghanistan Asia       1992    41.7 16317921      649.  16.3 
10 Afghanistan Asia       1997    41.8 22227415      635.  22.2 
# ℹ 1,694 more rows</code></pre>
</div>
</div>
</section>
<section id="mit-vorhandenen-spalten-arbeiten" class="level4" data-number="4.3.5.3">
<h4 data-number="4.3.5.3" class="anchored" data-anchor-id="mit-vorhandenen-spalten-arbeiten"><span class="header-section-number">4.3.5.3</span> Mit vorhandenen Spalten arbeiten</h4>
<p>Wie mit Konstanten können wir auch <strong>mit anderen Variablen arbeiten</strong>, jeweils Zeile für Zeile. In der Tabelle <code>gapminder</code> ist so nur das Pro-Kopf-BIP (<code>gdpPercap</code>) gegeben. Wenn wir aber des gesamte BIP wissen des jeweiligen Landes nutzen wollten, müssten wir diese Angabe mit der Bevölkerungszahl (<code>pop</code>) multiplizieren.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gdp =</span> gdpPercap <span class="sc">*</span> pop) <span class="sc">|&gt;</span>  <span class="co"># Erzeugen einer neuen Variable gdp durch Multiplikation von gdpPercap und pop</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>) <span class="co"># Aus Platzgründen: Nur die obersten drei Zeilen anzeigen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 7
  country     continent  year lifeExp      pop gdpPercap         gdp
  &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;       &lt;dbl&gt;
1 Afghanistan Asia       1952    28.8  8425333      779. 6567086330.
2 Afghanistan Asia       1957    30.3  9240934      821. 7585448670.
3 Afghanistan Asia       1962    32.0 10267083      853. 8758855797.</code></pre>
</div>
</div>
<p>Wenn wir mit vorhandenen Spalten arbeiten wollen, möchten wir manchmal <strong>innerhalb einer Spalte auf bestimmte Werte zugreifen</strong>. Hierfür gibt es vier besonders nützliche <strong>Hilfsfunktionen</strong>:</p>
<ul>
<li><strong><code>first()</code></strong>: Diese Funktion auf den <em>ersten</em> Wert eines Vektors zu.</li>
<li><strong><code>last()</code></strong>: Diese Funktion greift auf den <em>letzten</em> Wert eines Vektors zu.</li>
<li><strong><code>lag()</code></strong> (“zögern” oder “nachhängen”): Diese Funktion greift auf den <em>vorangegangenen</em> Wert eines Vektors zu.</li>
<li><strong><code>lead()</code></strong> (“führen” oder “voreilen”): Diese Funktion greift auf den <em>folgenden</em> Wert eines Vektors zu.</li>
</ul>
<p>Diese Funktionen können wir unter anderem nutzen, wenn wir <strong>Veränderungen</strong> berechnen wollen. Dies möchten wir anhand eines Beispiels der durchschnittlichen Lebenserwartung für Deutschland verstehen. Hierfür weisen wir zunächst einem Ausschnitt von <code>gapminder</code> den Namen <code>gapminder_germany</code> zu.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>gapminder_germany <span class="ot">&lt;-</span> gapminder <span class="sc">|&gt;</span> </span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">"Germany"</span>) <span class="sc">|&gt;</span> <span class="co"># Beobachtungen für Deutschland auswählen</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, year, lifeExp) <span class="co"># Spalten country, year und lifeExp auswählen</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>gapminder_germany</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 3
   country  year lifeExp
   &lt;fct&gt;   &lt;int&gt;   &lt;dbl&gt;
 1 Germany  1952    67.5
 2 Germany  1957    69.1
 3 Germany  1962    70.3
 4 Germany  1967    70.8
 5 Germany  1972    71  
 6 Germany  1977    72.5
 7 Germany  1982    73.8
 8 Germany  1987    74.8
 9 Germany  1992    76.1
10 Germany  1997    77.3
11 Germany  2002    78.7
12 Germany  2007    79.4</code></pre>
</div>
</div>
<p>Möchten wir berechnen, wie sich die Lebenserwartung jeder Beobachtung hinsichtlich eines Referenzjahres, in diesem Beispiel 1952, darstellt (man spricht hier von einer <strong>Indexierung</strong>), müssen wir mit <code>first(lifeExp)</code> nur auf die erste Beobachtung verweisen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>gapminder_germany <span class="sc">|&gt;</span> </span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lifeExp_index =</span> lifeExp <span class="sc">/</span> <span class="fu">first</span>(lifeExp)) <span class="co"># Erzeugen einer neuen Variable lifeExp_index durch die Berechnung des Verhältnisses zwischen lifeExp und first(lifeExp)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
   country  year lifeExp lifeExp_index
   &lt;fct&gt;   &lt;int&gt;   &lt;dbl&gt;         &lt;dbl&gt;
 1 Germany  1952    67.5          1   
 2 Germany  1957    69.1          1.02
 3 Germany  1962    70.3          1.04
 4 Germany  1967    70.8          1.05
 5 Germany  1972    71            1.05
 6 Germany  1977    72.5          1.07
 7 Germany  1982    73.8          1.09
 8 Germany  1987    74.8          1.11
 9 Germany  1992    76.1          1.13
10 Germany  1997    77.3          1.15
11 Germany  2002    78.7          1.17
12 Germany  2007    79.4          1.18</code></pre>
</div>
</div>
<p>Wenn wir die <strong>Veränderung von einem Zeitpunkt zum nächsten berechnen</strong> wollen, können wir dies tun, indem wir für jede Zeile die Differenz zwischen <code>lifeExp</code> und dem vorangegangenen Wert, <code>lag(lifeExp)</code>, berechnen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>gapminder_germany <span class="sc">|&gt;</span> </span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lifeExp_change_years =</span> lifeExp <span class="sc">-</span> <span class="fu">lag</span>(lifeExp)) <span class="co"># Erzeugen einer neuen Variable lifeExp_change_years durch die Berechnung der Differenz zwischen lifeExp und lag(lifeExp)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
   country  year lifeExp lifeExp_change_years
   &lt;fct&gt;   &lt;int&gt;   &lt;dbl&gt;                &lt;dbl&gt;
 1 Germany  1952    67.5               NA    
 2 Germany  1957    69.1                1.60 
 3 Germany  1962    70.3                1.20 
 4 Germany  1967    70.8                0.5  
 5 Germany  1972    71                  0.200
 6 Germany  1977    72.5                1.5  
 7 Germany  1982    73.8                1.30 
 8 Germany  1987    74.8                1.05 
 9 Germany  1992    76.1                1.22 
10 Germany  1997    77.3                1.27 
11 Germany  2002    78.7                1.33 
12 Germany  2007    79.4                0.736</code></pre>
</div>
</div>
<p>Mit derlei absoluten Differenzen können wir weiterrechnen wie gewohnt. Mit einem kleinen Schritt können wir die <strong>prozentuale Veränderung</strong> berechnen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>gapminder_germany <span class="sc">|&gt;</span> </span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lifeExp_change_percent =</span> (lifeExp <span class="sc">-</span> <span class="fu">lag</span>(lifeExp)) <span class="sc">/</span> <span class="fu">lag</span>(lifeExp) <span class="sc">*</span> <span class="dv">100</span>) <span class="co"># Erzeugen einer neuen Variable lifeExp_change_percent durch die Berechnung der prozentualen Differenz zwischen lifeExp und lag(lifeExp)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
   country  year lifeExp lifeExp_change_percent
   &lt;fct&gt;   &lt;int&gt;   &lt;dbl&gt;                  &lt;dbl&gt;
 1 Germany  1952    67.5                 NA    
 2 Germany  1957    69.1                  2.37 
 3 Germany  1962    70.3                  1.74 
 4 Germany  1967    70.8                  0.711
 5 Germany  1972    71                    0.282
 6 Germany  1977    72.5                  2.11 
 7 Germany  1982    73.8                  1.79 
 8 Germany  1987    74.8                  1.42 
 9 Germany  1992    76.1                  1.63 
10 Germany  1997    77.3                  1.67 
11 Germany  2002    78.7                  1.72 
12 Germany  2007    79.4                  0.936</code></pre>
</div>
</div>
</section>
<section id="spalten-behalten" class="level4" data-number="4.3.5.4">
<h4 data-number="4.3.5.4" class="anchored" data-anchor-id="spalten-behalten"><span class="header-section-number">4.3.5.4</span> Spalten behalten</h4>
<p>Wenn wir neue Spalten erzeugen, können wir auswählen, <strong>welche Spalten der Ursprungstabelle in unserem <em>output</em> enthalten bleiben</strong> sollen. Das Argument hierfür heißt <strong><code>.keep</code></strong> und ist standardmäßig auf <code>"all"</code> gesetzt. Das heißt, sobald wir <code>mutate()</code> nutzen, werden <em>alle</em> Spalten der Ursprungstabelle beibehalten. Wir können stattdessen aber auch mit <code>.keep = "used"</code> nur solche Spalten behalten, die wir aktiv in unseren Berechnungen heranziehen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gdp =</span> gdpPercap <span class="sc">*</span> pop, <span class="co"># Erzeugen einer neuen Variable gdp durch Multiplikation von gdpPercap und pop</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">.keep =</span> <span class="st">"used"</span>) <span class="sc">|&gt;</span>  <span class="co"># Behalten nur verwendeter Spalten</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>) <span class="co"># Aus Platzgründen: Nur die obersten drei Zeilen anzeigen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
       pop gdpPercap         gdp
     &lt;int&gt;     &lt;dbl&gt;       &lt;dbl&gt;
1  8425333      779. 6567086330.
2  9240934      821. 7585448670.
3 10267083      853. 8758855797.</code></pre>
</div>
</div>
<p>Mit <code>"unused"</code> drehen wir diese Auswahl um, es werden nur <em>nicht</em> verwendete Spalten behalten.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gdp =</span> gdpPercap <span class="sc">*</span> pop, <span class="co"># Erzeugen einer neuen Variable gdp durch Multiplikation von gdpPercap und pop</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">.keep =</span> <span class="st">"used"</span>) <span class="sc">|&gt;</span>  <span class="co"># Behalten nur verwendeter Spalten</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>) <span class="co"># Aus Platzgründen: Nur die obersten drei Zeilen anzeigen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
       pop gdpPercap         gdp
     &lt;int&gt;     &lt;dbl&gt;       &lt;dbl&gt;
1  8425333      779. 6567086330.
2  9240934      821. 7585448670.
3 10267083      853. 8758855797.</code></pre>
</div>
</div>
<p>Zuletzt können wir mit <code>"none"</code> keine Spalten behalten, mit Ausnahme der neu erzeugten.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gdp =</span> gdpPercap <span class="sc">*</span> pop, <span class="co"># Erzeugen einer neuen Variable gdp durch Multiplikation von gdpPercap und pop</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">.keep =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span>  <span class="co"># Behalten nur verwendeter Spalten</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>) <span class="co"># Aus Platzgründen: Nur die obersten drei Zeilen anzeigen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 1
          gdp
        &lt;dbl&gt;
1 6567086330.
2 7585448670.
3 8758855797.</code></pre>
</div>
</div>
</section>
<section id="sec-datentransformation-spalten-mutating-bedingungen" class="level4" data-number="4.3.5.5">
<h4 data-number="4.3.5.5" class="anchored" data-anchor-id="sec-datentransformation-spalten-mutating-bedingungen"><span class="header-section-number">4.3.5.5</span> Mit Bedingungen arbeiten</h4>
<p>Regelmäßig kommt es vor, dass wir in einem Datensatz eine Variable auf der Basis von <strong>Bedingungen</strong> neu kodieren wollen. Das heißt, dass wir eine Formulierung nutzen wollen, die gesprochen etwa lauten würde: <em>Wenn Bedingung A zutrifft, dann soll der Inhalt der Variablen <code>X</code> sein, sonst soll der Inhalt der Variable <code>Y</code> sein.</em> Diese Verwendung von <strong><em>wenn</em></strong>, <strong><em>dann</em></strong> und <strong><em>sonst</em></strong> gibt der naheliegendsten Funktion ihren Namen: <strong><code>if_else()</code></strong>.<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a></p>
<p>Sie funktioniert so, dass zunächst ein Vektor auf eine Bedingung (<code>condition</code>) überprüft wird. Desweiteren geben wir an, was mit dem Wert geschehen soll, wenn die Bedingung erfüllt (<code>true</code>) ist und zuletzt, was mit dem Wert geschehen soll, wenn die Bedingung nicht erfüllt ist (<code>false</code>). Nehmen wir als <strong>Beispiel</strong> an, wir möchten einen Vektor (1, 2, 3, 4, 5) daraufhin überprüfen, ob die jeweiligen Werte größer als 2 sind (<code>&gt; 2</code>). Ist dies der Fall, soll der entsprechende Wert durch den Wert unverändert bleiben, sonst soll er durch <code>99</code> ersetzt werden. Als Code würden wir folgendes schreiben:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">if_else</span>(<span class="at">condition =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">&gt;</span> <span class="dv">2</span>, <span class="co"># Angeben der Bedingung </span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">true =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="co"># Was soll bei erfüllter Bedingung passieren?</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">false =</span> <span class="dv">99</span>) <span class="co"># Was soll bei unerfüllter Bedingung passieren?</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 99 99  3  4  5</code></pre>
</div>
</div>
<p>Derartige Transformationen sind nützlich, wenn wir zum Beispiel <strong>Gruppen</strong> bilden möchten (<a href="#sec-datentranformation-gruppen" class="quarto-xref"><span>Kapitel 4.4</span></a>) und dafür eine <strong>neue Variable</strong> benötigen. Nehmen wir hierfür an, wir möchten die Lebenserwartung innerhalb Europas vergleichen und sind insbesondere im Vergleich von Deutschland mit dem europäischen Durchschnitt außerhalb Deutschlands interessiert. Hierfür müssen wir nur <code>if_else()</code> innerhalb von <code>mutate()</code> nutzen, indem wir eine neue Variable <code>is_germany</code> erzeugen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">"Europe"</span>, year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">|&gt;</span> <span class="co"># Auswählen europäischer Länder im Jahr 2007</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, lifeExp) <span class="sc">|&gt;</span> </span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is_germany =</span> <span class="fu">if_else</span>(country <span class="sc">==</span> <span class="st">"Germany"</span>, <span class="co"># Angeben der Bedingung </span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">true =</span> <span class="cn">TRUE</span>, <span class="co"># Was soll bei erfüllter Bedingung passieren?</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">false =</span> <span class="cn">FALSE</span>)) <span class="sc">|&gt;</span> <span class="co"># Was soll bei unerfüllter Bedingung passieren?</span></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(is_germany)) <span class="co"># Aus Platzgründen: Absteigend nach is_germany ordnen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30 × 3
   country                lifeExp is_germany
   &lt;fct&gt;                    &lt;dbl&gt; &lt;lgl&gt;     
 1 Germany                   79.4 TRUE      
 2 Albania                   76.4 FALSE     
 3 Austria                   79.8 FALSE     
 4 Belgium                   79.4 FALSE     
 5 Bosnia and Herzegovina    74.9 FALSE     
 6 Bulgaria                  73.0 FALSE     
 7 Croatia                   75.7 FALSE     
 8 Czech Republic            76.5 FALSE     
 9 Denmark                   78.3 FALSE     
10 Finland                   79.3 FALSE     
# ℹ 20 more rows</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Weiterführendes Arbeiten mit Bedingungen
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>if_else()</code> ist ein einfaches Beispiel für das Arbeiten mit Bedingungen. Wenn es allerdings darum geht, mit <strong>mehreren Bedingungen</strong> zu arbeiten oder bestehende Werte <strong>umzukodieren</strong>, sind andere Funktionen aus dem <code>dplyr</code>-Werkzeugkasten wie <code>case_when()</code> oder <code>case_match()</code> hilfreich <span class="citation" data-cites="r4ds2023">(<a href="references.html#ref-r4ds2023" role="doc-biblioref">Wickham, Çetinkaya-Rundel, und Grolemund 2023, Kap. 12.5</a>)</span>.<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a></p>
</div>
</div>
</section>
</section>
</section>
<section id="sec-datentranformation-gruppen" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="sec-datentranformation-gruppen"><span class="header-section-number">4.4</span> Gruppen</h2>
<p>Nachdem wir bereits gesehen haben, wie wir mit einzelnen Vektoren nützliche Berechnungen anstellen können (<a href="03-grundlagen.html#sec-grundlagen-datenstrukturen-vektor" class="quarto-xref"><span>Kapitel 3.5.1</span></a>), ist der nächste Schritt, derartige Berechnungen auch mit den Inhalten von Tabellen durchzuführen.</p>
<p>Wie würden wir den zum Beispiel die <strong>mittlere Lebenserwartung</strong> je nach <strong>Kontinent</strong> in der <code>gapminder</code>-Tabelle berechnen? Mit <em>base R</em> würden wir so verfahren:</p>
<ol type="1">
<li>Eine Gruppe (z.B. <code>"Asia"</code>) mit der Indexschreibweise filtern: <code>gapminder[gapminder$continent == "Asia", ]</code></li>
<li>Aus der entsprechenden Tabelle den Vektor <code>lifeExp</code> mit dem <code>$</code>-Operator extrahieren: <code>gapminder[gapminder$continent == "Asia", ]$lifeExp</code></li>
<li>Mit <code>mean()</code> den entsprechenden Mittelwert berechnen: <code>mean(gapminder[gapminder$continent == "Asia", ]$lifeExp)</code></li>
</ol>
<p>Nicht nur ist diese Berechnung aber <strong>wenig ansprechend zu lesen</strong>, bei fünf Kontinenten müssten wir eine derartige Berechnung fünfmal manuell eingeben - und bei größeren Gruppen, etwa bei einer Berechnung nach Land, noch häufiger. Als R-Einsteiger suchen wir nach einer ansprechenden Lösung, die nicht auf <strong>fortgeschrittene Konzepte wie Schleifen</strong> o.ä. angewiesen ist. Glücklicherweise liegen mit <strong><code>group_by()</code></strong> und <strong><code>summarize()</code></strong> auch für diese häufigen Aufgaben entsprechende <code>dplyr</code>-Verben vor.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Schleifen
</div>
</div>
<div class="callout-body-container callout-body">
<p>Beim Programmieren bezeichnen Schleifen solche Anweisungen an ein Programm, <strong>dieselbe(n) Berechnung(en) für alle Elemente einer Datenstruktur zu wiederholen</strong>, z.B. für alle Werte eines Vektors oder alle Elemente einer Liste. Das Verwenden von Schleifen ist eine wichtige, aber für Einsteiger*innen durchaus voraussetzungvolle Fähigkeit. In diesem Kurs, mit dem die Grundlagen für weitere Kurse gelegt werden sollen, werden wir uns daher <strong>nicht</strong> mit ihnen beschäftigen.</p>
</div>
</div>
<section id="grouping" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="grouping"><span class="header-section-number">4.4.1</span> Grouping</h3>
<p>Viele Tabellen enthalten mehrere <strong>Gruppen</strong> von Beobachtungen. Eine Gruppe besteht dabei aus <strong>einer oder mehreren Beobachtungen, die einen bestimmten Wert einer Variable teilen</strong>. In der <code>gapminder</code>-Tabelle etwa sind Länder von 5 unterschiedlichen Kontinenten sowie 12 unterschiedliche Jahre enthalten. Wir könnten statt dessen auch von einer entsprechenden Anzahl an Kontinent- bzw. Jahres<em>gruppen</em> sprechen.</p>
<p><strong>Gruppen zu spezifizieren</strong> ist der erste Schritt, um gruppenweise Berechnungen anzustellen. Das entsprechende Verb hierfür ist <strong><code>group_by()</code></strong>, dem wir einfach diejenige Variable nennen, auf Basis derer wir Gruppen bilden möchten.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">|&gt;</span> <span class="co"># Gruppen auf Basis von continent bilden</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>) <span class="co"># Aus Platzgründen: Nur die obersten drei Zeilen (diesmal pro Gruppe, also 3 * 5 = 15) anzeigen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 6
# Groups:   continent [5]
   country     continent  year lifeExp      pop gdpPercap
   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
 1 Algeria     Africa     1952    43.1  9279525     2449.
 2 Algeria     Africa     1957    45.7 10270856     3014.
 3 Algeria     Africa     1962    48.3 11000948     2551.
 4 Argentina   Americas   1952    62.5 17876956     5911.
 5 Argentina   Americas   1957    64.4 19610538     6857.
 6 Argentina   Americas   1962    65.1 21283783     7133.
 7 Afghanistan Asia       1952    28.8  8425333      779.
 8 Afghanistan Asia       1957    30.3  9240934      821.
 9 Afghanistan Asia       1962    32.0 10267083      853.
10 Albania     Europe     1952    55.2  1282697     1601.
11 Albania     Europe     1957    59.3  1476505     1942.
12 Albania     Europe     1962    64.8  1728137     2313.
13 Australia   Oceania    1952    69.1  8691212    10040.
14 Australia   Oceania    1957    70.3  9712569    10950.
15 Australia   Oceania    1962    70.9 10794968    12217.</code></pre>
</div>
</div>
<p>Der <em>output</em> enthält mit <code># Groups:   continent [5]</code> den Hinweis, dass es sich nicht nur um eine <em>tibble</em>, sondern um eine <strong>gruppierte</strong> <em>tibble</em> handelt. Für jeden der fünf <code>continent</code>-Werte ist also eine Gruppe erzeugt worden. Einmal mit <code>group_by()</code> erzeugt, erfolgt <strong>jede weitere Berechnung auf Basis der Gruppen</strong>. (Das heißt, dass hier mit <code>slice_head(n = 3)</code> für jede Gruppe die obersten drei Zeilen ausgewählt werden, was in der Summe 3 * 5 = 15 Zeilen bedeutet.)</p>
<p>Gruppen können wir nicht nur auf Basis einer, sondern auch mehrerer Variablen bilden. Statt nur <code>continent</code>, können wir auch <code>continent</code> (5 Gruppen) und <code>year</code>(12 Gruppen) heranziehen, was also 60 Gruppen bedeutet, wie aus unserem <em>output</em> hervorgeht.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent, year) <span class="sc">|&gt;</span> <span class="co"># Gruppen auf Basis von continent und year bilden</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>) <span class="co"># Aus Platzgründen: Nur die obersten drei Zeilen (diesmal pro Gruppe, also 3 * 5 * 12 = 180) anzeigen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 168 × 6
# Groups:   continent, year [60]
   country continent  year lifeExp      pop gdpPercap
   &lt;fct&gt;   &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
 1 Algeria Africa     1952    43.1  9279525     2449.
 2 Angola  Africa     1952    30.0  4232095     3521.
 3 Benin   Africa     1952    38.2  1738315     1063.
 4 Algeria Africa     1957    45.7 10270856     3014.
 5 Angola  Africa     1957    32.0  4561361     3828.
 6 Benin   Africa     1957    40.4  1925173      960.
 7 Algeria Africa     1962    48.3 11000948     2551.
 8 Angola  Africa     1962    34    4826015     4269.
 9 Benin   Africa     1962    42.6  2151895      949.
10 Algeria Africa     1967    51.4 12760499     3247.
# ℹ 158 more rows</code></pre>
</div>
</div>
</section>
<section id="summarizing" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="summarizing"><span class="header-section-number">4.4.2</span> Summarizing</h3>
<p>Gruppen zu bilden, ist der erste Schritt hin zu gruppenweisen Berechnungen. Der zweite Schritt ist die Kombination mit weiteren <code>dplyr</code>-Verben, wie bereits am Beispiel von <code>slice_head()</code> gezeigt. Die womöglich am häufigsten genutzte Funktion in Verbindung mit <code>group_by()</code> ist <strong><code>summarize()</code></strong><a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a> (zu deutsch “zusammenfassen”). Wie ihr Name suggeriert, handelt es sich um die zentrale Funktion zur Berechnung sogenannter <strong><em>summary statistics</em></strong>, also zusammenfassender beschreibender statistischer Maße. Der Zweck dieser Maße ist, unsere Datensätze besser kennenzulernen.</p>
<p>Viele der Maße kennen wir bereits (<a href="03-grundlagen.html#sec-grundlagen-datenstrukturen-vektor" class="quarto-xref"><span>Kapitel 3.5.1</span></a>). Um ihre Funktionen mit <code>summarize()</code> zu nutzen, rufen wir sie innerhalb von <code>summarize()</code> auf und nennen die Variable, auf die wir eine bestimmte Berechnung anwenden wollen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">|&gt;</span> <span class="co"># Gruppen auf Basis von continent bilden</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">mean</span>(lifeExp)) <span class="co"># Mittelwert von lifeExp berechnen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  continent `mean(lifeExp)`
  &lt;fct&gt;               &lt;dbl&gt;
1 Africa               48.9
2 Americas             64.7
3 Asia                 60.1
4 Europe               71.9
5 Oceania              74.3</code></pre>
</div>
</div>
<p>Unser <em>output</em> hat also für alle fünf Gruppen von <code>continent</code> den entsprechenden Mittelwert berechnet. Dabei ist der resultierende <strong>Variablenname</strong> <code>mean(lifeExp)</code> unschön. Wir können aber auf die uns von <code>mutate()</code> bekannte Weise einen <strong>neuen Namen</strong> für unsere berechnete Variable geben.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">|&gt;</span> <span class="co"># Gruppen auf Basis von continent bilden</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_life_exp =</span> <span class="fu">mean</span>(lifeExp)) <span class="co"># Mittelwert von lifeExp berechnen und mean_life_exp nennen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  continent mean_life_exp
  &lt;fct&gt;             &lt;dbl&gt;
1 Africa             48.9
2 Americas           64.7
3 Asia               60.1
4 Europe             71.9
5 Oceania            74.3</code></pre>
</div>
</div>
<p>Diesen Code können wir nun immer weiter verfeinern und mit <strong>Verschachtelungen</strong> ergänzen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">|&gt;</span> <span class="co"># Gruppen auf Basis von continent bilden</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_life_exp =</span> <span class="fu">round</span>(<span class="fu">mean</span>(lifeExp))) <span class="co"># Gerundeten Mittelwert von lifeExp berechnen und mean_life_exp nennen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  continent mean_life_exp
  &lt;fct&gt;             &lt;dbl&gt;
1 Africa               49
2 Americas             65
3 Asia                 60
4 Europe               72
5 Oceania              74</code></pre>
</div>
</div>
<p>Dabei sind wir nicht auf die Berechnung <em>einer</em> neuen Variable beschränkt, sondern können in einem Schritt <strong>mehrere</strong> neue Variablen erzeugen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">|&gt;</span> <span class="co"># Gruppen auf Basis von continent bilden</span></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_life_exp =</span> <span class="fu">round</span>(<span class="fu">mean</span>(lifeExp)), <span class="co"># Gerundeten Mittelwert von lifeExp berechnen und mean_life_exp nennen</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd_life_exp =</span> <span class="fu">round</span>(<span class="fu">sd</span>(lifeExp))) <span class="co"># Gerundete Standardabweichung von lifeExp berechnen und sd_life_exp nennen </span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  continent mean_life_exp sd_life_exp
  &lt;fct&gt;             &lt;dbl&gt;       &lt;dbl&gt;
1 Africa               49           9
2 Americas             65           9
3 Asia                 60          12
4 Europe               72           5
5 Oceania              74           4</code></pre>
</div>
</div>
<p>Zugleich können wir immer feinere Gruppen bilden, indem wir wie zuvor <strong>weitere Gruppierungsvariablen</strong> hinzufügen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent, year) <span class="sc">|&gt;</span> <span class="co"># Gruppen auf Basis von continent und year bilden</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_life_exp =</span> <span class="fu">round</span>(<span class="fu">mean</span>(lifeExp)), <span class="co"># Gerundeten Mittelwert von lifeExp berechnen und mean_life_exp nennen</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd_life_exp =</span> <span class="fu">round</span>(<span class="fu">sd</span>(lifeExp))) <span class="co"># Gerundete Standardabweichung von lifeExp berechnen und sd_life_exp nennen </span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 60 × 4
# Groups:   continent [5]
   continent  year mean_life_exp sd_life_exp
   &lt;fct&gt;     &lt;int&gt;         &lt;dbl&gt;       &lt;dbl&gt;
 1 Africa     1952            39           5
 2 Africa     1957            41           6
 3 Africa     1962            43           6
 4 Africa     1967            45           6
 5 Africa     1972            47           6
 6 Africa     1977            50           7
 7 Africa     1982            52           7
 8 Africa     1987            53           8
 9 Africa     1992            54           9
10 Africa     1997            54           9
# ℹ 50 more rows</code></pre>
</div>
</div>
<p>Wenn immer wir <em>summary statistics</em> berechnen, ist es außerdem ratsam, anzugeben, auf wieviele Beobachtungen sich eine Statistik stützt. Mit <strong><code>n()</code></strong> können wir dies für jede Gruppe berechnen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent, year) <span class="sc">|&gt;</span> <span class="co"># Gruppen auf Basis von continent und year bilden</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_life_exp =</span> <span class="fu">round</span>(<span class="fu">mean</span>(lifeExp)), <span class="co"># Gerundeten Mittelwert von lifeExp berechnen und mean_life_exp nennen</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd_life_exp =</span> <span class="fu">round</span>(<span class="fu">sd</span>(lifeExp)), <span class="co"># Gerundete Standardabweichung von lifeExp berechnen und sd_life_exp nennen </span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">obs =</span> <span class="fu">n</span>()) <span class="co"># Zahl der Beobachtungen berechnen und obs nennen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 60 × 5
# Groups:   continent [5]
   continent  year mean_life_exp sd_life_exp   obs
   &lt;fct&gt;     &lt;int&gt;         &lt;dbl&gt;       &lt;dbl&gt; &lt;int&gt;
 1 Africa     1952            39           5    52
 2 Africa     1957            41           6    52
 3 Africa     1962            43           6    52
 4 Africa     1967            45           6    52
 5 Africa     1972            47           6    52
 6 Africa     1977            50           7    52
 7 Africa     1982            52           7    52
 8 Africa     1987            53           8    52
 9 Africa     1992            54           9    52
10 Africa     1997            54           9    52
# ℹ 50 more rows</code></pre>
</div>
</div>
<p>Zuletzt ist wichtig, zu wissen, dass der <strong><em>output</em> der Kombination von <code>group_by()</code> und <code>summarize()</code> immer eine gruppierte <em>tibble</em></strong> ist. Um diese Gruppen “aufzulösen” – etwa, weil wir mit der Ergebnistabelle anders weiterrechnen wollen – können wir entweder <code>ungroup()</code> als weiteres Verb anfügen oder innerhalb von <code>summarize()</code> das Argument <code>.groups</code> auf <code>"drop"</code> setzen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">|&gt;</span> <span class="co"># Gruppen auf Basis von continent bilden</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_life_exp =</span> <span class="fu">round</span>(<span class="fu">mean</span>(lifeExp))) <span class="sc">|&gt;</span> <span class="co"># Gerundeten Mittelwert von lifeExp berechnen und mean_life_exp nennen</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="co"># Gruppen auflösen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  continent mean_life_exp
  &lt;fct&gt;             &lt;dbl&gt;
1 Africa               49
2 Americas             65
3 Asia                 60
4 Europe               72
5 Oceania              74</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">|&gt;</span> <span class="co"># Gruppen auf Basis von continent bilden</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_life_exp =</span> <span class="fu">round</span>(<span class="fu">mean</span>(lifeExp)),</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="co"># Gerundeten Mittelwert von lifeExp berechnen und mean_life_exp nennen, Gruppen auflösen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  continent mean_life_exp
  &lt;fct&gt;             &lt;dbl&gt;
1 Africa               49
2 Americas             65
3 Asia                 60
4 Europe               72
5 Oceania              74</code></pre>
</div>
</div>
<p>In beiden Fälle verschwindet aus dem <em>output</em> der Hinweis auf <code># Groups</code>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<code>group_by()</code> vs.&nbsp;<code>.by</code>
</div>
</div>
<div class="callout-body-container callout-body">
<p>In jüngerer Vergangenheit wurde die Funktion <code>summarize()</code> so überarbeitet, dass sie ein eigenes Argument <code>.by</code> enthält, dass <code>group_by()</code> überflüssig macht. Der Aufruf</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">|&gt;</span> </span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_life_exp =</span> <span class="fu">mean</span>(lifeExp))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>kann inzwischen entsprechend auch als</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_life_exp =</span> <span class="fu">mean</span>(lifeExp), </span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">.by =</span> continent)<span class="st">`</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>geschrieben werden. Dennoch kann es insbesondere zu Beginn sinnvoll sein, <code>group_by()</code> auszuschreiben, um die Logik des Codes besser nachvollziehen zu können.</p>
</div>
</div>
</section>
</section>
<section id="sec-datentransformation-uebungsaufgaben" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="sec-datentransformation-uebungsaufgaben"><span class="header-section-number">4.5</span> Übungsaufgaben</h2>
<p>Der Datensatz dieser Übungsaufgaben ist <code>flights</code>, welcher im Paket <code>nycflights13</code> enthalten ist. Installieren und laden Sie zunächst <code>nycflights13</code>.<a href="#fn15" class="footnote-ref" id="fnref15" role="doc-noteref"><sup>15</sup></a></p>
<section id="überblick-verschaffen" class="level3" data-number="4.5.1">
<h3 data-number="4.5.1" class="anchored" data-anchor-id="überblick-verschaffen"><span class="header-section-number">4.5.1</span> Überblick verschaffen</h3>
<p>Verschaffen Sie sich zunächst mittels geeigneter Funktionsaufrufe einen Eindruck von <code>flights</code>.</p>
<ol type="1">
<li>Wieviele Zeilen hat die Tabelle?</li>
<li>Wieviele Spalten hat die Tabelle?</li>
<li>Welche Datentypen haben die einzelnen Variablen?</li>
<li>Welche Informationen enthalten die einzelnen Variablen?</li>
</ol>
</section>
<section id="filtering-1" class="level3" data-number="4.5.2">
<h3 data-number="4.5.2" class="anchored" data-anchor-id="filtering-1"><span class="header-section-number">4.5.2</span> Filtering</h3>
<p>Filtern Sie <code>flights</code> nach den folgenden Bedingungen. Wieviele Zeilen bleiben von den ursprünglich 336776 Zeilen übrig?</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tipp
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wenn Sie an <code>flights |&gt; filter(...)</code> noch mit <code>|&gt;</code> die Funktion <code>nrow()</code> anhängen, wird Ihnen nur die Anzahl der Spalten angezeigt.</p>
</div>
</div>
<ol type="1">
<li>Verspätete Ankunft von mindestens zwei Stunden</li>
<li>Ankunft in Houston, Texas (<code>IAH</code> oder <code>HOU</code>)</li>
<li>Fluggesellschaft United, American oder Delta (<code>UA</code>, <code>AA</code> oder <code>DL</code>)</li>
<li>Abflug im Sommer (Juli, August oder September)</li>
<li>Pünktlicher Abflug, aber um mehr als zwei Stunden verspätete Ankunft</li>
<li>Um mindestens eine Stunde verspäteter Abflug, aber um weniger als 30 Minuten verspätete Ankunft</li>
</ol>
</section>
<section id="einmalige-kombinationen" class="level3" data-number="4.5.3">
<h3 data-number="4.5.3" class="anchored" data-anchor-id="einmalige-kombinationen"><span class="header-section-number">4.5.3</span> Einmalige Kombinationen</h3>
<p>Nutzen Sie <code>distinct()</code>, um zu überprüfen, ob an jedem Tag im Jahr 2013 ein Flug stattfand.</p>
</section>
<section id="slicing" class="level3" data-number="4.5.4">
<h3 data-number="4.5.4" class="anchored" data-anchor-id="slicing"><span class="header-section-number">4.5.4</span> Slicing</h3>
<p>Nutzen Sie eine der <code>slice_*</code>-Funktionen, um die folgenden Fragen zu beantworten.</p>
<ol type="1">
<li>Welche drei Flüge haben die größte Distanz zurückgelegt?</li>
<li>Welche drei Flüge haben die geringste Distanz zurückgelegt?</li>
<li>Welche fünf Flüge waren am längsten unterwegs?</li>
<li>Welche fünf Flüge waren am kürzesten unterwegs?</li>
</ol>
</section>
<section id="arranging" class="level3" data-number="4.5.5">
<h3 data-number="4.5.5" class="anchored" data-anchor-id="arranging"><span class="header-section-number">4.5.5</span> Arranging</h3>
<p>Ordnen Sie die Tabelle nach den folgenden Kriterien.</p>
<ol type="1">
<li>Aufsteigend nach Fluggesellschaft</li>
<li>Aufsteigend nach Fluggesellschaft und absteigend nach Verspätung bei Ankunft</li>
<li>Absteigend nach Monat und aufsteigend nach Tag</li>
<li>Aufsteigend nach Destination, absteigend nach Verspätung bei Abflug</li>
<li>Absteigend nach Geschwindigkeit</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tipp
</div>
</div>
<div class="callout-body-container callout-body">
<p>Sie können auch innerhalb von <code>arrange()</code> Berechnungen verwenden. Für Aufgabe von nutzen Sie am besten eine Berechnung mithilfe der Variablen <code>distance</code> und <code>air_time</code>.</p>
</div>
</div>
</section>
<section id="selecting-1" class="level3" data-number="4.5.6">
<h3 data-number="4.5.6" class="anchored" data-anchor-id="selecting-1"><span class="header-section-number">4.5.6</span> Selecting</h3>
<p>Wählen Sie folgende Spalten aus.</p>
<ol type="1">
<li><code>carrier</code> anhand ihrer Position</li>
<li><code>carrier</code> anhand ihres Namens</li>
<li><code>dep_time</code>, <code>sched_dep_time</code> und <code>dep_delay</code> anhand ihrer Namen</li>
<li><code>year</code> bis <code>flight</code> (<em>Überlegen Sie, wie Sie hier möglichst kurzen Code schreiben können.</em>)</li>
<li>Alle Spalten, deren Bezeichnungen mit <code>"a"</code> beginnen</li>
<li>Alle Spalten, deren Bezeichnungen mit <code>"time"</code> enden</li>
<li>Alle Spalten, deren Bezeichnungen <code>"rr"</code> enthalten</li>
<li>Alle Spalten, jedoch mit den Spalten <code>carrier</code>, <code>flight</code> und <code>tailnum</code> zuvorderst</li>
</ol>
</section>
<section id="renaming-und-relocating" class="level3" data-number="4.5.7">
<h3 data-number="4.5.7" class="anchored" data-anchor-id="renaming-und-relocating"><span class="header-section-number">4.5.7</span> Renaming und Relocating</h3>
<ol type="1">
<li>Benennen Sie die Spalte <code>air_time</code> in <code>air_time_min</code> um, um die Maßeinheit anzugeben.</li>
<li>Ziehen Sie die Spalten <code>carrier</code>, <code>flight</code> und <code>tailnum</code> (wie zuvor mit <code>select()</code>) nach vorn.</li>
<li>Verschieben Sie die Spalte <code>dep_delay</code> so, dass sie sich zwischen <code>dep_time</code> und <code>sched_dep_time</code> befindet.</li>
</ol>
</section>
<section id="mutating" class="level3" data-number="4.5.8">
<h3 data-number="4.5.8" class="anchored" data-anchor-id="mutating"><span class="header-section-number">4.5.8</span> Mutating</h3>
<ol type="1">
<li>Wie glauben Sie, hängen <code>dep_time</code>, <code>sched_dep_time</code> und <code>dep_delay</code> zusammen? Vollziehen Sie die Berechnung nach und überprüfen, ob Sie zum selben Ergebnis kommen.</li>
<li>Berechnen Sie eine neue Variable <code>speed</code> auf Basis von <code>distance</code> und <code>air_time</code>.</li>
<li>Berechnen Sie eine neue Variable <code>air_time_hours</code> auf Basis von <code>air_time</code>, sodass die Maßeinheit Stunden, nicht Minuten beträgt.</li>
</ol>
</section>
<section id="grouping-und-summarizing" class="level3" data-number="4.5.9">
<h3 data-number="4.5.9" class="anchored" data-anchor-id="grouping-und-summarizing"><span class="header-section-number">4.5.9</span> Grouping und Summarizing</h3>
<p>Berechnen Sie…</p>
<ol type="1">
<li>…die durchschnittliche Ankunftsverspätung je Fluggesellschaft.</li>
<li>…die längste zurückgelegte Distanz je Fluggesellschaft.</li>
<li>…die kürzeste zurückgelegte Distanz je Fluggesellschaft.</li>
<li>…den Medianwert der Abflugsverspätung je Flughafen.</li>
</ol>
</section>
<section id="längere-dplyr-pipelines" class="level3" data-number="4.5.10">
<h3 data-number="4.5.10" class="anchored" data-anchor-id="längere-dplyr-pipelines"><span class="header-section-number">4.5.10</span> Längere <code>dplyr</code>-Pipelines</h3>
<p>Überlegen Sie, in welcher Reihenfolge Sie die Ihnen bekannten Funktionen kombinieren müssen, um die folgenden Fragen zu beantworten.</p>
<ol type="1">
<li>Welche Fluggesellschaft flog im März mit der höchsten durchschnittlichen Geschwindigkeit?</li>
<li>Welche Fluggesellschaft konnte ihre Abflugsverspätung durchschnittlich am besten während des Fluges ausgleichen?</li>
<li>In welchem Monat war die durchschnittliche Distanz von New York City ausgehender Flüge am höchsten?</li>
<li>Welcher Flughafen wurde von New York City aus im Dezember am häufigsten angeflogen?</li>
<li>Welche Route zwischen dem Abflugsflughafen und Zielflughafen vereinigt die meisten Flüge auf sich?</li>
</ol>
</section>
<section id="fortgeschrittenes" class="level3" data-number="4.5.11">
<h3 data-number="4.5.11" class="anchored" data-anchor-id="fortgeschrittenes"><span class="header-section-number">4.5.11</span> Fortgeschrittenes</h3>
<ol type="1">
<li>Überlegen Sie sich eine eigene auf <code>flights</code> bezogene Fragestellung, für deren Beantwortung Sie mindestens vier <code>dplyr</code>-Funktionen nutzen müssen.</li>
<li><code>group_by()</code> ist nicht nur in Verbindung mit <code>summarize()</code> nützlich, sondern kann auch mit <code>mutate()</code> genutzt werden. Überlegen Sie, wie Sie für jeden Flug einer Fluggesellschaft die Differenz seiner Ankunftsverzögerung von der durchschnittlichen Ankunftsverzögerung aller Flüge der Fluggesellschaft berechnen können.</li>
</ol>
</section>
</section>
<section id="lösungen" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="lösungen"><span class="header-section-number">4.6</span> Lösungen</h2>
<section id="überblick-verschaffen-1" class="level3" data-number="4.6.1">
<h3 data-number="4.6.1" class="anchored" data-anchor-id="überblick-verschaffen-1"><span class="header-section-number">4.6.1</span> Überblick verschaffen</h3>
<ol type="1">
<li><code>nrow(flights)</code></li>
<li><code>ncol(flights)</code></li>
<li><code>str(flights)</code></li>
<li><code>?flights</code></li>
</ol>
</section>
<section id="filtering-2" class="level3" data-number="4.6.2">
<h3 data-number="4.6.2" class="anchored" data-anchor-id="filtering-2"><span class="header-section-number">4.6.2</span> Filtering</h3>
<ol type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dep_delay <span class="sc">&gt;</span> <span class="dv">120</span>) <span class="sc">|&gt;</span> </span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dest <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"IAH"</span>, <span class="st">"HOU"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(carrier <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"UA"</span>, <span class="st">"AA"</span>, <span class="st">"DL"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="4" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(month, <span class="dv">7</span>, <span class="dv">9</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="5" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dep_delay <span class="sc">&lt;=</span> <span class="dv">0</span>, arr_delay <span class="sc">&gt;</span> <span class="dv">120</span>) <span class="sc">|&gt;</span> </span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="6" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dep_delay <span class="sc">&gt;=</span> <span class="dv">60</span>, arr_delay <span class="sc">&lt;</span> <span class="dv">30</span>) <span class="sc">|&gt;</span> </span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="einmalige-kombinationen-1" class="level3" data-number="4.6.3">
<h3 data-number="4.6.3" class="anchored" data-anchor-id="einmalige-kombinationen-1"><span class="header-section-number">4.6.3</span> Einmalige Kombinationen</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(year, month, day) <span class="sc">|&gt;</span> </span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="slicing-1" class="level3" data-number="4.6.4">
<h3 data-number="4.6.4" class="anchored" data-anchor-id="slicing-1"><span class="header-section-number">4.6.4</span> Slicing</h3>
<p>Nutzen Sie eine der <code>slice_*</code>-Funktionen, um die folgenden Fragen zu beantworten.</p>
<ol type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(distance, <span class="at">n =</span> <span class="dv">3</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_min</span>(distance, <span class="at">n =</span> <span class="dv">3</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(air_time, <span class="at">n =</span> <span class="dv">5</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="4" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_min</span>(air_time, <span class="at">n =</span> <span class="dv">5</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="arranging-1" class="level3" data-number="4.6.5">
<h3 data-number="4.6.5" class="anchored" data-anchor-id="arranging-1"><span class="header-section-number">4.6.5</span> Arranging</h3>
<ol type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(carrier)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(carrier, <span class="fu">desc</span>(arr_delay), <span class="fu">desc</span>(dep_delay))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(month), day)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="4" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(dest, <span class="fu">desc</span>(arr_delay))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="5" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(distance <span class="sc">/</span> air_time))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="selecting-2" class="level3" data-number="4.6.6">
<h3 data-number="4.6.6" class="anchored" data-anchor-id="selecting-2"><span class="header-section-number">4.6.6</span> Selecting</h3>
<ol type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">10</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(carrier)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(dep_time, sched_dep_time, dep_delay)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="4" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year<span class="sc">:</span>flight)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="5" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"a"</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="6" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">"time"</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="7" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">"rr"</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="8" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(carrier, flight, tailnum, <span class="fu">everything</span>())</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="renaming-und-relocating-1" class="level3" data-number="4.6.7">
<h3 data-number="4.6.7" class="anchored" data-anchor-id="renaming-und-relocating-1"><span class="header-section-number">4.6.7</span> Renaming und Relocating</h3>
<ol type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">air_time_min =</span> air_time)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(carrier, flight, tailnum)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(dep_delay, <span class="at">.after =</span> dep_time)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mutating-1" class="level3" data-number="4.6.8">
<h3 data-number="4.6.8" class="anchored" data-anchor-id="mutating-1"><span class="header-section-number">4.6.8</span> Mutating</h3>
<ol type="1">
<li><code>dep_delay</code> gibt die Differenz zwischen der geplanten (<code>sched_dep_time</code>) und tatsächlichen Abflugszeit (<code>dep_time</code>) an. Weil die Zeitangabe aber im Format <code>HHMM</code> ist, können wir die Berechnung nur teilweise nachvollziehen.</li>
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">speed =</span> distance <span class="sc">/</span> air_time)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">air_time_hours =</span> air_time <span class="sc">/</span> <span class="dv">60</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="grouping-und-summarizing-1" class="level3" data-number="4.6.9">
<h3 data-number="4.6.9" class="anchored" data-anchor-id="grouping-und-summarizing-1"><span class="header-section-number">4.6.9</span> Grouping und Summarizing</h3>
<ol type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(carrier) <span class="sc">|&gt;</span> </span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_arr_delay =</span> <span class="fu">mean</span>(arr_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(carrier) <span class="sc">|&gt;</span> </span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">max_distance =</span> <span class="fu">max</span>(distance))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(carrier) <span class="sc">|&gt;</span> </span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">min_distance =</span> <span class="fu">min</span>(distance))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="4" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(origin) <span class="sc">|&gt;</span> </span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">median_dep_delay =</span> <span class="fu">median</span>(dep_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="längere-dplyr-pipelines-1" class="level3" data-number="4.6.10">
<h3 data-number="4.6.10" class="anchored" data-anchor-id="längere-dplyr-pipelines-1"><span class="header-section-number">4.6.10</span> Längere <code>dplyr</code>-Pipelines</h3>
<p>Überlegen Sie, in welcher Reihenfolge Sie die Ihnen bekannten Funktionen kombinieren müssen, um die folgenden Fragen zu beantworten.</p>
<ol type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(month <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(carrier) <span class="sc">|&gt;</span> </span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_speed =</span> <span class="fu">mean</span>(distance <span class="sc">/</span> air_time)) <span class="sc">|&gt;</span> </span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(mean_speed, <span class="at">n =</span> <span class="dv">1</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">delay_gain =</span> arr_delay <span class="sc">-</span> dep_delay) <span class="sc">|&gt;</span> </span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(carrier) <span class="sc">|&gt;</span> </span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_delay_gain =</span> <span class="fu">mean</span>(delay_gain, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_min</span>(mean_delay_gain, <span class="at">n =</span> <span class="dv">1</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month) <span class="sc">|&gt;</span> </span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_distance =</span> <span class="fu">mean</span>(distance)) <span class="sc">|&gt;</span> </span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(mean_distance, <span class="at">n =</span> <span class="dv">1</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="4" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(month <span class="sc">==</span> <span class="dv">12</span>) <span class="sc">|&gt;</span> </span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(dest) <span class="sc">|&gt;</span> </span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(n, <span class="at">n =</span> <span class="dv">1</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="5" type="1">
<li>Welche Route zwischen dem Abflugsflughafen und Zielflughafen vereinigt die meisten Flüge auf sich?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(origin, dest) <span class="sc">|&gt;</span> </span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(n, <span class="at">n =</span> <span class="dv">1</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="fortgeschrittenes-1" class="level3" data-number="4.6.11">
<h3 data-number="4.6.11" class="anchored" data-anchor-id="fortgeschrittenes-1"><span class="header-section-number">4.6.11</span> Fortgeschrittenes</h3>
<ol type="1">
<li>Hierbei handelt es sich um eine eigene zu entwickelnde Fragestellung. Eine Lösung kann also nicht angeboten werden.</li>
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(carrier) <span class="sc">|&gt;</span> </span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dep_delay_difference_from_carrier_mean =</span> dep_delay <span class="sc">-</span> <span class="fu">mean</span>(dep_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-r4ds2023" class="csl-entry" role="listitem">
Wickham, Hadley, Mine Çetinkaya-Rundel, und Garrett Grolemund. 2023. <em>R for Data Science. Import, Tidy, Transform, Visualize and Model Data</em>. 2nd Aufl. Sebastopol: O’Reilly. <a href="https://r4ds.hadley.nz/">https://r4ds.hadley.nz/</a>.
</div>
</div>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Natürlich könnten wir aber auch jedes einzeln laden, aber sobald wir auch nur zwei <em>packages</em> benötigen, können wir uns so eine Zeile Code sparen.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Diese Bezugnahme auf eine Funktion haben wir bereits in <a href="03-grundlagen.html#sec-grundlagen-datenstrukturen-tibble" class="quarto-xref"><span>Kapitel 3.5.4</span></a> gesehen.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Dieses Konzept wird später in <a href="07-datenbereinigung.html#sec-datenbereinigung-tidy-data" class="quarto-xref"><span>Kapitel 7.1</span></a> erläutert.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Die Bezeichnung stammt daher, dass tatsächliche englische Verben als Funktionsnamen gewählt wurden.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Geben wir <code>n</code> nicht an, wird laut der Dokumentation (<code>?slice_min</code>) jeweils <code>n = 1</code> verwendet.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>Ist <code>x</code> ein <code>character</code>-Vektor, gilt der Buchstabe A als der “niedrigste” und der Buchstabe Z als der “höchste” Wert.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>Die geringste Lebenserwartung im Datensatz in Höhe von bloß von 23,6 Jahren wies Ruanda im Jahr 1992 auf, als es zu einem <a href="https://de.wikipedia.org/wiki/V%C3%B6lkermord_in_Ruanda">genozidalen Bürgerkrieg</a> kam.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>Siehe <code>?count</code>.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>Siehe <code>?num_range()</code>.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>Dieselbe Wirkung lässt sich mit <code>-</code> erzielen, für das Beispiel also <code>gapminder |&gt; select(-1)</code>.<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p>Dieser Schritt ist identisch mit <code>select()</code>, nur das Ergebnis ist ein anderes.<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p><em>base R</em> verfügt über eine Funktion namens <code>ifelse()</code>, die <code>if_else()</code> nur <a href="https://stackoverflow.com/questions/50646133/dplyr-if-else-vs-base-r-ifelse">leicht verändert</a> hat.<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13"><p>Eine kurze Einführung in diese zwei Funktionen liefert ebenfalls <a href="https://debruine.github.io/post/case_functions/">dieser Blogpost</a>.<a href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn14"><p>Jede <code>tidyverse</code>-Funktion, die die <em>American English</em>-Endung <code>*ize()</code> enthält, existiert auch als <em>British English</em>-Alternative <code>*ise()</code>.<a href="#fnref14" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn15"><p>Die folgenden Aufgaben basieren auf <span class="citation" data-cites="r4ds2023">(<a href="references.html#ref-r4ds2023" role="doc-biblioref">Wickham, Çetinkaya-Rundel, und Grolemund 2023, Kap. 3</a>)</span>.<a href="#fnref15" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./03-grundlagen.html" class="pagination-link" aria-label="Grundlagen">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Grundlagen</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./05-datenvisualisierung.html" class="pagination-link" aria-label="Datenvisualisierung">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Datenvisualisierung</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>